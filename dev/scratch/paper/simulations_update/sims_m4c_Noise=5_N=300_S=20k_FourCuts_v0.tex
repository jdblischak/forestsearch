\documentclass[8pt]{article}\usepackage[]{graphicx}\usepackage[]{xcolor}
% maxwidth is the original width if it is less than linewidth
% otherwise use linewidth (to make sure the graphics do not exceed the margin)
\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

\definecolor{fgcolor}{rgb}{0.345, 0.345, 0.345}
\newcommand{\hlnum}[1]{\textcolor[rgb]{0.686,0.059,0.569}{#1}}%
\newcommand{\hlstr}[1]{\textcolor[rgb]{0.192,0.494,0.8}{#1}}%
\newcommand{\hlcom}[1]{\textcolor[rgb]{0.678,0.584,0.686}{\textit{#1}}}%
\newcommand{\hlopt}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlstd}[1]{\textcolor[rgb]{0.345,0.345,0.345}{#1}}%
\newcommand{\hlkwa}[1]{\textcolor[rgb]{0.161,0.373,0.58}{\textbf{#1}}}%
\newcommand{\hlkwb}[1]{\textcolor[rgb]{0.69,0.353,0.396}{#1}}%
\newcommand{\hlkwc}[1]{\textcolor[rgb]{0.333,0.667,0.333}{#1}}%
\newcommand{\hlkwd}[1]{\textcolor[rgb]{0.737,0.353,0.396}{\textbf{#1}}}%
\let\hlipl\hlkwb

\usepackage{framed}
\makeatletter
\newenvironment{kframe}{%
 \def\at@end@of@kframe{}%
 \ifinner\ifhmode%
  \def\at@end@of@kframe{\end{minipage}}%
  \begin{minipage}{\columnwidth}%
 \fi\fi%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadecolor}{##1}\hskip-\fboxsep
     % There is no \\@totalrightmargin, so:
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed%
 \at@end@of@kframe}
\makeatother

\definecolor{shadecolor}{rgb}{.97, .97, .97}
\definecolor{messagecolor}{rgb}{0, 0, 0}
\definecolor{warningcolor}{rgb}{1, 0, 1}
\definecolor{errorcolor}{rgb}{1, 0, 0}
\newenvironment{knitrout}{}{} % an empty environment to be redefined in TeX

\usepackage{alltt}
\usepackage{multicol}
\usepackage{amssymb,mathrsfs,graphicx}
\usepackage{enumerate}
\usepackage{amsthm}
\usepackage{lscape}
\usepackage{pdfpages}
\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]

\theoremstyle{remark}
\newtheorem{remark}{Remark}

\usepackage[colorlinks=true,linkcolor={blue},citecolor={blue},urlcolor={blue}]{hyperref}
\usepackage{longtable,ctable}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{multirow}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{mathptmx}
\usepackage{natbib}
\usepackage{setspace}

\usepackage[utf8]{inputenc}
\usepackage{pgf}

\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{enumerate}
\usepackage{threeparttable}


\newcommand{\R}{R}
\newcommand{\gbsg}{gbsg}

\def\FsNg{\hbox{FS}(M_{g})}

\def\hhat{\hat\theta(\hat{H})}
\def\hchat{\hat\theta(\hat{H}^{c})}
\def\hknow{\hat\theta(H)}
\def\hcknow{\hat\theta(H^{c})}
\def\hplim{\theta^{\dagger}(H)}
\def\hcplim{\theta^{\dagger}(H^{c})}


\newcommand{\indep}{\perp \!\!\! \perp}

\textheight=9.25in \textwidth=6.0in 
\topmargin=0in
\evensidemargin=0in \oddsidemargin=0in
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\begin{document}

\raggedbottom





\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{N} \hlkwb{<-} \hlnum{300}
\hlstd{Nsims} \hlkwb{<-} \hlnum{20} \hlopt{*} \hlnum{1000}

\hlstd{maxFollow} \hlkwb{<-} \hlnum{84}
\hlstd{cens.type} \hlkwb{<-} \hlstr{"weibull"}
\hlcom{######################### Forest search criteria}
\hlstd{hr.threshold} \hlkwb{<-} \hlnum{1.25}  \hlcom{# Initital candidates }
\hlstd{hr.consistency} \hlkwb{<-} \hlnum{1}  \hlcom{# Candidates for many splits}

\hlstd{pconsistency.threshold} \hlkwb{<-} \hlnum{0.9}
\hlstd{stop.threshold} \hlkwb{<-} \hlnum{0.95}

\hlstd{maxk} \hlkwb{<-} \hlnum{2}
\hlstd{nmin.fs} \hlkwb{<-} \hlnum{60}
\hlstd{pstop_futile} \hlkwb{<-} \hlnum{0.7}

\hlcom{# Limit timing for forestsearch}
\hlstd{max.minutes} \hlkwb{<-} \hlnum{3}
\hlstd{m1.threshold} \hlkwb{<-} \hlnum{Inf}  \hlcom{# Turning this off (Default)}
\hlcom{# pconsistency.threshold<-0.70 # Minimum threshold (will choose max among}
\hlcom{# subgroups satisfying)}
\hlstd{fs.splits} \hlkwb{<-} \hlnum{400}  \hlcom{# How many times to split for consistency}
\hlcom{# vi is % factor is selected in cross-validation --> higher more important}
\hlstd{vi.grf.min} \hlkwb{<-} \hlstd{(}\hlopt{-}\hlnum{1}\hlstd{)} \hlopt{*} \hlnum{0.2}  \hlcom{# This is default (to NOT exclude via VI)}
\hlcom{# Null, turns off grf screening}
\hlstd{d.min} \hlkwb{<-} \hlnum{10}  \hlcom{# Min number of events for both arms (d0.min=d1.min=d.min)}
\hlcom{# default=5}

\hlcom{########################## Virtual twins analysis Counter-factual difference}
\hlcom{########################## (C-E) >= vt.threshold Large values in favor of C}
\hlcom{########################## (control)}
\hlstd{vt.threshold} \hlkwb{<-} \hlnum{0.225}  \hlcom{# For VT delta}
\hlstd{treat.threshold} \hlkwb{<-} \hlnum{0}

\hlstd{maxdepth} \hlkwb{<-} \hlnum{2}
\hlstd{n.min} \hlkwb{<-} \hlnum{60}
\hlstd{ntree} \hlkwb{<-} \hlnum{1000}

\hlcom{# GRF criteria}
\hlstd{dmin.grf} \hlkwb{<-} \hlnum{12}  \hlcom{# For GRF delta}
\hlcom{# Note: For CRT this represents dmin.grf/2 RMS for control (-dmin.grf/2 for}
\hlcom{# treatment)}
\hlstd{frac.tau} \hlkwb{<-} \hlnum{0.6}

\hlcom{# For forestsearch algorithm use same as GRF}
\hlstd{frac.tau_fs} \hlkwb{<-} \hlnum{0.6}
\hlstd{dmin.grf_fs} \hlkwb{<-} \hlnum{12}
\hlstd{maxdepth_fs} \hlkwb{<-} \hlnum{2}

\hlstd{label.analyses} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlstr{"FSl"}\hlstd{,} \hlstr{"GRF"}\hlstd{,} \hlstr{"VT(24)"}\hlstd{,} \hlstr{"VT#(24)"}\hlstd{,} \hlstr{"VT(36)"}\hlstd{,} \hlstr{"VT#(36)"}\hlstd{,} \hlstr{"GRF.60"}\hlstd{)}
\hlcom{# Classification table names}
\hlstd{est_names} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlstr{"$FS_\{g\}$"}\hlstd{,} \hlstr{"$FS_\{lg\}$"}\hlstd{,} \hlstr{"$GRF$"}\hlstd{,} \hlstr{"$GRF_\{60\}$"}\hlstd{,} \hlstr{"$VT(24)$"}\hlstd{,} \hlstr{"$\{VT\}^\{\textbackslash{}\textbackslash{}#\}(24)$"}\hlstd{,}
    \hlstr{"$VT(36)$"}\hlstd{,} \hlstr{"$\{VT\}^\{\textbackslash{}\textbackslash{}#\}(36)$"}\hlstd{)}

\hlstd{outcome.name} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlstr{"y.sim"}\hlstd{)}
\hlstd{event.name} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlstr{"event.sim"}\hlstd{)}
\hlstd{id.name} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlstr{"id"}\hlstd{)}
\hlstd{treat.name} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlstr{"treat"}\hlstd{)}

\hlstd{cox.formula.sim} \hlkwb{<-} \hlkwd{as.formula}\hlstd{(}\hlkwd{paste}\hlstd{(}\hlstr{"Surv(y.sim,event.sim)~treat"}\hlstd{))}
\hlstd{cox.formula.adj.sim} \hlkwb{<-} \hlkwd{as.formula}\hlstd{(}\hlkwd{paste}\hlstd{(}\hlstr{"Surv(y.sim,event.sim)~treat+v1+v2+v3+v4+v5"}\hlstd{))}

\hlstd{get.FS} \hlkwb{<-} \hlnum{TRUE}
\hlstd{get.VT} \hlkwb{<-} \hlnum{TRUE}
\hlstd{get.GRF} \hlkwb{<-} \hlnum{TRUE}

\hlstd{fl_prefix} \hlkwb{<-} \hlkwd{paste0}\hlstd{(}\hlstr{"oc_sims="}\hlstd{, Nsims,} \hlstr{"_"}\hlstd{)}

\hlstd{out.loc} \hlkwb{<-} \hlkwd{paste0}\hlstd{(}\hlstr{"results/"}\hlstd{, fl_prefix)}

\hlcom{# m1 -censoring adjustment}
\hlstd{muC.adj} \hlkwb{<-} \hlkwd{log}\hlstd{(}\hlnum{1.5}\hlstd{)}

\hlcom{# 0, 3, or 5}
\hlstd{n_add_noise} \hlkwb{<-} \hlnum{5}

\hlstd{mindex} \hlkwb{<-} \hlstr{"m4c"}
\hlstd{file.index} \hlkwb{<-} \hlstr{"v0-4cuts"}

\hlstd{z1_frac} \hlkwb{<-} \hlnum{0.25}

\hlkwa{if} \hlstd{(mindex} \hlopt{==} \hlstr{"m4a"}\hlstd{) \{}
    \hlstd{k.z3} \hlkwb{<-} \hlnum{1}
    \hlstd{k.treat} \hlkwb{<-} \hlnum{0.9}
    \hlstd{pH_super} \hlkwb{<-} \hlnum{0.125}  \hlcom{# non-NULL re-defines z1_frac}
\hlstd{\}}

\hlkwa{if} \hlstd{(mindex} \hlopt{==} \hlstr{"m4aB"}\hlstd{) \{}
    \hlstd{k.z3} \hlkwb{<-} \hlnum{1}
    \hlstd{k.treat} \hlkwb{<-} \hlnum{0.9}
    \hlstd{pH_super} \hlkwb{<-} \hlnum{0.2}  \hlcom{# non-NULL re-defines z1_frac}
\hlstd{\}}

\hlkwa{if} \hlstd{(mindex} \hlopt{==} \hlstr{"m4b"}\hlstd{) \{}
    \hlstd{k.z3} \hlkwb{<-} \hlnum{1}
    \hlstd{k.treat} \hlkwb{<-} \hlnum{1.25}
    \hlstd{pH_super} \hlkwb{<-} \hlnum{0.3}  \hlcom{# non-NULL re-defines z1_frac}
\hlstd{\}}

\hlkwa{if} \hlstd{(mindex} \hlopt{==} \hlstr{"m4c"}\hlstd{) \{}
    \hlstd{k.z3} \hlkwb{<-} \hlnum{1}
    \hlstd{k.treat} \hlkwb{<-} \hlnum{1.5}
    \hlstd{pH_super} \hlkwb{<-} \hlnum{0.3}  \hlcom{# non-NULL re-defines z1_frac}
\hlstd{\}}

\hlstd{model.index} \hlkwb{<-} \hlkwd{paste0}\hlstd{(mindex,} \hlstr{"-Noise="}\hlstd{,} \hlstr{""}\hlstd{)}
\hlstd{model.index} \hlkwb{<-} \hlkwd{paste0}\hlstd{(model.index, n_add_noise,} \hlstr{""}\hlstd{)}

\hlkwa{if} \hlstd{(}\hlkwd{is.null}\hlstd{(pH_super)) \{}
    \hlcom{# pH_check<-with(gbsg,mean(pgr<=quantile(pgr,c(z3_frac),1,0) &}
    \hlcom{# er<=quantile(er,z1_frac)))}
    \hlstd{pH_check} \hlkwb{<-} \hlkwd{with}\hlstd{(gbsg,} \hlkwd{mean}\hlstd{(meno} \hlopt{==} \hlnum{0} \hlopt{&} \hlstd{er} \hlopt{<=} \hlkwd{quantile}\hlstd{(er, z1_frac)))}
    \hlkwd{cat}\hlstd{(}\hlstr{"Underlying pH_super"}\hlstd{,} \hlkwd{c}\hlstd{(pH_check),} \hlstr{"\textbackslash{}n"}\hlstd{)}
\hlstd{\}}
\hlcom{# pH_super specified If pH_super then override z1_frac and find z1_frac to}
\hlcom{# yield pH_super}

\hlkwa{if} \hlstd{(}\hlopt{!}\hlkwd{is.null}\hlstd{(pH_super)) \{}
    \hlcom{# Approximate Z1 quantile to yield pH proportion}
    \hlstd{z1_q} \hlkwb{<-} \hlkwd{uniroot}\hlstd{(propH.obj4,} \hlkwd{c}\hlstd{(}\hlnum{0}\hlstd{,} \hlnum{1}\hlstd{),} \hlkwc{tol} \hlstd{=} \hlnum{1e-04}\hlstd{,} \hlkwc{pH.target} \hlstd{= pH_super)}\hlopt{$}\hlstd{root}
    \hlcom{# pH_check<-with(gbsg,mean(pgr<=quantile(pgr,c(z3_frac),1,0) &}
    \hlcom{# er<=quantile(er,z1_q)))}
    \hlstd{pH_check} \hlkwb{<-} \hlkwd{with}\hlstd{(gbsg,} \hlkwd{mean}\hlstd{(meno} \hlopt{==} \hlnum{0} \hlopt{&} \hlstd{er} \hlopt{<=} \hlkwd{quantile}\hlstd{(er, z1_q)))}
    \hlkwd{cat}\hlstd{(}\hlstr{"pH"}\hlstd{,} \hlkwd{c}\hlstd{(pH_check),} \hlstr{"\textbackslash{}n"}\hlstd{)}
    \hlstd{rel_error} \hlkwb{<-} \hlstd{(pH_super} \hlopt{-} \hlstd{pH_check)}\hlopt{/}\hlstd{pH_super}
    \hlkwa{if} \hlstd{(}\hlkwd{abs}\hlstd{(rel_error)} \hlopt{>=} \hlnum{0.1}\hlstd{)}
        \hlkwd{stop}\hlstd{(}\hlstr{"pH_super approximation relative error exceeds 10%"}\hlstd{)}
    \hlstd{z1_frac} \hlkwb{<-} \hlstd{z1_q}
    \hlkwd{cat}\hlstd{(}\hlstr{"Underlying pH_super"}\hlstd{,} \hlkwd{c}\hlstd{(pH_check),} \hlstr{"\textbackslash{}n"}\hlstd{)}
\hlstd{\}}
\end{alltt}
\begin{verbatim}
## pH 0.3002915 
## Underlying pH_super 0.3002915
\end{verbatim}
\begin{alltt}
\hlcom{# Bootstrap on log(hr) scale converted to HR (est.loghr=TRUE & est.scale='hr')}
\hlstd{est.loghr} \hlkwb{<-} \hlnum{TRUE}
\hlstd{est.scale} \hlkwb{<-} \hlstr{"hr"}
\hlstd{t.start.all} \hlkwb{<-} \hlkwd{proc.time}\hlstd{()[}\hlnum{3}\hlstd{]}

\hlcom{# Classification table names Note: within tab_tests (summary.VTFS) we rename so}
\hlcom{# that denominator in ppv(hatH) is # hatH Manuscript section 3.2 will be}
\hlcom{# updated accordingly}

\hlstd{stat_names} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlstr{"any(H)"}\hlstd{,} \hlstr{"$\{sens\}(\textbackslash{}\textbackslash{}hat\{H\})$"}\hlstd{,} \hlstr{"$\{sens\}(\textbackslash{}\textbackslash{}hat\{H\}^\{C\})$"}\hlstd{,} \hlstr{"$\{ppv\}(\textbackslash{}\textbackslash{}hat\{H\})$"}\hlstd{,}
    \hlstr{"$\{ppv\}(\textbackslash{}\textbackslash{}hat\{H\}^\{C\})$"}\hlstd{,} \hlstr{"$\{avg\}\textbackslash{}\textbackslash{}vert \textbackslash{}\textbackslash{}hat\{H\} \textbackslash{}\textbackslash{}vert$"}\hlstd{,} \hlstr{"$\{min\}\textbackslash{}\textbackslash{}vert \textbackslash{}\textbackslash{}hat\{H\} \textbackslash{}\textbackslash{}vert$"}\hlstd{,}
    \hlstr{"$\{max\}\textbackslash{}\textbackslash{}vert \textbackslash{}\textbackslash{}hat\{H\} \textbackslash{}\textbackslash{}vert$"}\hlstd{,} \hlstr{"$\{avg\}\textbackslash{}\textbackslash{}vert \textbackslash{}\textbackslash{}hat\{H\}^\{C\} \textbackslash{}\textbackslash{}vert$"}\hlstd{,} \hlstr{"$\{min\}\textbackslash{}\textbackslash{}vert \textbackslash{}\textbackslash{}hat\{H\}^\{C\} \textbackslash{}\textbackslash{}vert$"}\hlstd{,}
    \hlstr{"$\{max\}\textbackslash{}\textbackslash{}vert \textbackslash{}\textbackslash{}hat\{H\}^\{C\} \textbackslash{}\textbackslash{}vert$"}\hlstd{)}

\hlkwa{if} \hlstd{(}\hlopt{!}\hlstd{get.FS) est_names} \hlkwb{<-} \hlstd{est_names[}\hlopt{-}\hlkwd{c}\hlstd{(}\hlnum{1}\hlopt{:}\hlnum{3}\hlstd{)]}
\end{alltt}
\end{kframe}
\end{knitrout}


\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{mod.harm} \hlkwb{<-} \hlstr{"null"}
\hlstd{this.dgm} \hlkwb{<-} \hlkwd{get.dgm4.OC}\hlstd{(}\hlkwc{mod.harm} \hlstd{= mod.harm,} \hlkwc{N} \hlstd{= N,} \hlkwc{k.treat} \hlstd{= k.treat,} \hlkwc{model.index} \hlstd{= model.index,}
    \hlkwc{sol_tol} \hlstd{=} \hlnum{10}\hlopt{^-}\hlnum{8}\hlstd{,} \hlkwc{hrH.target} \hlstd{= hrH.target,} \hlkwc{cens.type} \hlstd{= cens.type,} \hlkwc{out.loc} \hlstd{= out.loc,}
    \hlkwc{file.index} \hlstd{= file.index,} \hlkwc{details} \hlstd{=} \hlnum{TRUE}\hlstd{,} \hlkwc{parms_torand} \hlstd{=} \hlnum{FALSE}\hlstd{)}
\end{alltt}
\end{kframe}
\includegraphics[width=\maxwidth]{figure/r_null-1} 
\begin{kframe}\begin{verbatim}
## Super-population empirical harm and non-harm hazard ratios= NA 0.5517234 
## Causal HR (empirical ITT)= 0.5517234
\end{verbatim}
\begin{alltt}
\hlstd{dgm} \hlkwb{<-} \hlstd{this.dgm}\hlopt{$}\hlstd{dgm}
\hlstd{output.file} \hlkwb{<-} \hlstd{this.dgm}\hlopt{$}\hlstd{out.file}

\hlkwa{if} \hlstd{(}\hlopt{!}\hlkwd{is.null}\hlstd{(output.file)} \hlopt{& !}\hlkwd{grepl}\hlstd{(mod.harm, output.file))} \hlkwd{stop}\hlstd{(}\hlstr{"Wrong file name for mod.harm"}\hlstd{)}

\hlcom{# Show first simulation ans1 <- oc_analyses_m4_FS4(1)}

\hlstd{t.start} \hlkwb{<-} \hlkwd{proc.time}\hlstd{()[}\hlnum{3}\hlstd{]}
\hlstd{res} \hlkwb{<-} \hlkwd{foreach}\hlstd{(}\hlkwc{sim} \hlstd{=} \hlkwd{seq_len}\hlstd{(Nsims),} \hlkwc{.options.future} \hlstd{=} \hlkwd{list}\hlstd{(}\hlkwc{seed} \hlstd{=} \hlnum{TRUE}\hlstd{),} \hlkwc{.combine} \hlstd{=} \hlstr{"rbind"}\hlstd{,}
    \hlkwc{.errorhandling} \hlstd{=} \hlstr{"pass"}\hlstd{)} \hlopt{%dofuture%} \hlstd{\{}
    \hlstd{ans} \hlkwb{<-} \hlkwd{oc_analyses_m4FourCuts_FS4}\hlstd{(sim)}
    \hlkwd{return}\hlstd{(ans)}
\hlstd{\}}
\end{alltt}
\begin{verbatim}
## FS: GRF stage for cut selection with dmin,tau= 12 0.6 
## tau, maxdepth= 45.33113 2 
##   leaf.node control.mean control.size control.se depth
## 1         2        -6.60       256.00       1.60     1
## 2         4        -8.24       200.00       1.81     2
##   leaf.node control.mean control.size control.se depth
## 1         2         -6.6        256.0        1.6     1
## GRF subgroup NOT found 
## NO GRF cuts meeting delta(RMST): dmin.grf= 12 
## # of continuous/categorical characteristics 6 6 
## Continuous characteristics: size noise1 noise2 noise3 noise4 noise5 
## Categorical characteristics: z1 z2 z3 z4 z5 grade3 
## Default cuts included (1st 20) 
## Categorical: z1 z2 z3 z4 z5 grade3 
## # of candidate subgroup factors= 25 
##  [1] "size <= 29.6"   "size <= 25"     "size <= 21"     "size <= 35"    
##  [5] "noise1 <= 0"    "noise1 <= -0.6" "noise1 <= 0.7"  "noise2 <= 0"   
##  [9] "noise2 <= -0.7" "noise2 <= 0.7"  "noise3 <= 0"    "noise3 <= -0.7"
## [13] "noise3 <= 0.8"  "noise4 <= 0"    "noise4 <= -0.8" "noise4 <= 0.7" 
## [17] "noise5 <= -0.1" "noise5 <= -0.8" "noise5 <= 0.5"  "z1"            
## [21] "z2"             "z3"             "z4"             "z5"            
## [25] "grade3"        
## Number of factors evaluated= 25 
## Confounders per grf screening q4 q23 q16 q19 q3 q20 q5 q24 q2 q17 q22 q8 q14 q11 q21 q10 q1 q12 q7 q13 q9 q18 q6 q25 q15 
##           Factors Labels VI(grf)
## 4      size <= 35     q4  0.0947
## 23             z4    q23  0.0735
## 16  noise4 <= 0.7    q16  0.0710
## 19  noise5 <= 0.5    q19  0.0693
## 3      size <= 21     q3  0.0624
## 20             z1    q20  0.0518
## 5     noise1 <= 0     q5  0.0417
## 24             z5    q24  0.0413
## 2      size <= 25     q2  0.0411
## 17 noise5 <= -0.1    q17  0.0411
## 22             z3    q22  0.0400
## 8     noise2 <= 0     q8  0.0379
## 14    noise4 <= 0    q14  0.0352
## 11    noise3 <= 0    q11  0.0336
## 21             z2    q21  0.0299
## 10  noise2 <= 0.7    q10  0.0297
## 1    size <= 29.6     q1  0.0280
## 12 noise3 <= -0.7    q12  0.0271
## 7   noise1 <= 0.7     q7  0.0263
## 13  noise3 <= 0.8    q13  0.0237
## 9  noise2 <= -0.7     q9  0.0236
## 18 noise5 <= -0.8    q18  0.0209
## 6  noise1 <= -0.6     q6  0.0208
## 25         grade3    q25  0.0177
## 15 noise4 <= -0.8    q15  0.0176
## Number of possible configurations (<= maxk): maxk, # <= maxk 2 1275 
## Approximately 5% of max_count met: minutes 0.00205 
## Approximately 10% of max_count met: minutes 0.00315 
## Approximately 20% of max_count met: minutes 0.006033333 
## Approximately 33% of max_count met: minutes 0.008883333 
## Approximately 50% of max_count met: minutes 0.01401667 
## Approximately 75% of max_count met: minutes 0.02173333 
## Approximately 90% of max_count met: minutes 0.02563333 
## # of subgroups evaluated based on (up to) maxk-factor combinations 1275 
## % of all-possible combinations (<= maxk) 100 
## k.max= 2 
## Events criteria for control,exp= 10 10 
## # of subgroups with events less than criteria: control, experimental 179 333 
## # of subgroups with sample size less than criteria 543 
## # of subgroups meeting all criteria = 705 
## # of subgroups fitted (Cox model estimable) = 705 
## *Subgroup Searching Minutes=* 0.02736667 
## Number of subgroups meeting HR threshold 0 
## NO subgroup candidate found (FS) 
## FS: GRF stage for cut selection with dmin,tau= 12 0.6 
## tau, maxdepth= 45.33113 2 
##   leaf.node control.mean control.size control.se depth
## 1         2        -6.60       256.00       1.60     1
## 2         4        -8.24       200.00       1.81     2
##   leaf.node control.mean control.size control.se depth
## 1         2         -6.6        256.0        1.6     1
## GRF subgroup NOT found 
## NO GRF cuts meeting delta(RMST): dmin.grf= 12 
## # of continuous/categorical characteristics 6 6 
## Continuous characteristics: size noise1 noise2 noise3 noise4 noise5 
## Categorical characteristics: z1 z2 z3 z4 z5 grade3 
## CV lambda = 0.04773978 
## 12 x 1 sparse Matrix of class "dgCMatrix"
##                 s0
## z1      .         
## z2      .         
## z3      .         
## z4      0.43629892
## z5     -0.52002399
## size    .         
## grade3  .         
## noise1  .         
## noise2 -0.03740061
## noise3  .         
## noise4  .         
## noise5  .         
## Cox-LASSO selected: z4 z5 noise2 
## Cox-LASSO not selected: z1 z2 z3 size grade3 noise1 noise3 noise4 noise5 
## Default cuts included from Lasso: 
## Categorical after Lasso: z4 z5 
## # of candidate subgroup factors= 21 
##  [1] "size <= 29.6"   "size <= 25"     "size <= 21"     "size <= 35"    
##  [5] "noise1 <= 0"    "noise1 <= -0.6" "noise1 <= 0.7"  "noise2 <= 0"   
##  [9] "noise2 <= -0.7" "noise2 <= 0.7"  "noise3 <= 0"    "noise3 <= -0.7"
## [13] "noise3 <= 0.8"  "noise4 <= 0"    "noise4 <= -0.8" "noise4 <= 0.7" 
## [17] "noise5 <= -0.1" "noise5 <= -0.8" "noise5 <= 0.5"  "z4"            
## [21] "z5"            
## Number of factors evaluated= 21 
## Confounders per grf screening q4 q20 q16 q19 q3 q17 q8 q5 q21 q2 q14 q11 q10 q7 q12 q1 q18 q6 q9 q15 q13 
##           Factors Labels VI(grf)
## 4      size <= 35     q4  0.1035
## 20             z4    q20  0.0892
## 16  noise4 <= 0.7    q16  0.0833
## 19  noise5 <= 0.5    q19  0.0786
## 3      size <= 21     q3  0.0651
## 17 noise5 <= -0.1    q17  0.0495
## 8     noise2 <= 0     q8  0.0494
## 5     noise1 <= 0     q5  0.0474
## 21             z5    q21  0.0472
## 2      size <= 25     q2  0.0465
## 14    noise4 <= 0    q14  0.0398
## 11    noise3 <= 0    q11  0.0393
## 10  noise2 <= 0.7    q10  0.0371
## 7   noise1 <= 0.7     q7  0.0346
## 12 noise3 <= -0.7    q12  0.0324
## 1    size <= 29.6     q1  0.0302
## 18 noise5 <= -0.8    q18  0.0270
## 6  noise1 <= -0.6     q6  0.0262
## 9  noise2 <= -0.7     q9  0.0258
## 15 noise4 <= -0.8    q15  0.0247
## 13  noise3 <= 0.8    q13  0.0232
## Number of possible configurations (<= maxk): maxk, # <= maxk 2 903 
## Approximately 5% of max_count met: minutes 0.001816667 
## Approximately 10% of max_count met: minutes 0.002066667 
## Approximately 20% of max_count met: minutes 0.006366667 
## Approximately 33% of max_count met: minutes 0.008283333 
## Approximately 50% of max_count met: minutes 0.0115 
## Approximately 75% of max_count met: minutes 0.0166 
## Approximately 90% of max_count met: minutes 0.01888333 
## # of subgroups evaluated based on (up to) maxk-factor combinations 903 
## % of all-possible combinations (<= maxk) 100 
## k.max= 2 
## Events criteria for control,exp= 10 10 
## # of subgroups with events less than criteria: control, experimental 140 232 
## # of subgroups with sample size less than criteria 393 
## # of subgroups meeting all criteria = 486 
## # of subgroups fitted (Cox model estimable) = 486 
## *Subgroup Searching Minutes=* 0.02021667 
## Number of subgroups meeting HR threshold 0 
## NO subgroup candidate found (FS) 
## FS: GRF stage for cut selection with dmin,tau= 12 0.6 
## tau, maxdepth= 45.32879 2 
##    leaf.node control.mean control.size control.se depth
## 1          2        -4.25       284.00       1.46     1
## 11         4        -6.05       111.00       2.27     2
## 4          7        -7.56       122.00       2.36     2
##   leaf.node control.mean control.size control.se depth
## 1         2        -4.25       284.00       1.46     1
## GRF subgroup NOT found 
## NO GRF cuts meeting delta(RMST): dmin.grf= 12 
## # of continuous/categorical characteristics 6 6 
## Continuous characteristics: size noise1 noise2 noise3 noise4 noise5 
## Categorical characteristics: z1 z2 z3 z4 z5 grade3 
## Default cuts included (1st 20) 
## Categorical: z1 z2 z3 z4 z5 grade3 
## # of candidate subgroup factors= 26 
##  [1] "size <= 27.9"   "size <= 25"     "size <= 20"     "size <= 34"    
##  [5] "noise1 <= 0.1"  "noise1 <= -0.7" "noise1 <= 0.7"  "noise2 <= 0"   
##  [9] "noise2 <= -0.1" "noise2 <= -0.6" "noise2 <= 0.7"  "noise3 <= 0"   
## [13] "noise3 <= -0.7" "noise3 <= 0.7"  "noise4 <= 0"    "noise4 <= -0.8"
## [17] "noise4 <= 0.7"  "noise5 <= 0.1"  "noise5 <= -0.5" "noise5 <= 0.8" 
## [21] "z1"             "z2"             "z3"             "z4"            
## [25] "z5"             "grade3"        
## Number of factors evaluated= 26 
## Confounders per grf screening q24 q1 q2 q16 q22 q25 q15 q18 q5 q20 q12 q3 q21 q8 q26 q9 q23 q7 q10 q19 q6 q4 q11 q13 q14 q17 
##           Factors Labels VI(grf)
## 24             z4    q24  0.0994
## 1    size <= 27.9     q1  0.0618
## 2      size <= 25     q2  0.0614
## 16 noise4 <= -0.8    q16  0.0614
## 22             z2    q22  0.0599
## 25             z5    q25  0.0580
## 15    noise4 <= 0    q15  0.0546
## 18  noise5 <= 0.1    q18  0.0431
## 5   noise1 <= 0.1     q5  0.0425
## 20  noise5 <= 0.8    q20  0.0385
## 12    noise3 <= 0    q12  0.0382
## 3      size <= 20     q3  0.0346
## 21             z1    q21  0.0338
## 8     noise2 <= 0     q8  0.0308
## 26         grade3    q26  0.0295
## 9  noise2 <= -0.1     q9  0.0288
## 23             z3    q23  0.0273
## 7   noise1 <= 0.7     q7  0.0260
## 10 noise2 <= -0.6    q10  0.0234
## 19 noise5 <= -0.5    q19  0.0234
## 6  noise1 <= -0.7     q6  0.0233
## 4      size <= 34     q4  0.0229
## 11  noise2 <= 0.7    q11  0.0224
## 13 noise3 <= -0.7    q13  0.0206
## 14  noise3 <= 0.7    q14  0.0188
## 17  noise4 <= 0.7    q17  0.0157
## Number of possible configurations (<= maxk): maxk, # <= maxk 2 1378 
## Approximately 5% of max_count met: minutes 0.002916667 
## Approximately 10% of max_count met: minutes 0.0053 
## Approximately 20% of max_count met: minutes 0.0095 
## Approximately 33% of max_count met: minutes 0.01625 
## Approximately 50% of max_count met: minutes 0.02488333 
## Approximately 75% of max_count met: minutes 0.03638333 
## Approximately 90% of max_count met: minutes 0.04121667 
## # of subgroups evaluated based on (up to) maxk-factor combinations 1378 
## % of all-possible combinations (<= maxk) 100 
## k.max= 2 
## Events criteria for control,exp= 10 10 
## # of subgroups with events less than criteria: control, experimental 203 440 
## # of subgroups with sample size less than criteria 575 
## # of subgroups meeting all criteria = 752 
## # of subgroups fitted (Cox model estimable) = 752 
## *Subgroup Searching Minutes=* 0.04413333 
## Number of subgroups meeting HR threshold 0 
## NO subgroup candidate found (FS) 
## FS: GRF stage for cut selection with dmin,tau= 12 0.6 
## tau, maxdepth= 45.32879 2 
##    leaf.node control.mean control.size control.se depth
## 1          2        -4.25       284.00       1.46     1
## 11         4        -6.05       111.00       2.27     2
## 4          7        -7.56       122.00       2.36     2
##   leaf.node control.mean control.size control.se depth
## 1         2        -4.25       284.00       1.46     1
## GRF subgroup NOT found 
## NO GRF cuts meeting delta(RMST): dmin.grf= 12 
## # of continuous/categorical characteristics 6 6 
## Continuous characteristics: size noise1 noise2 noise3 noise4 noise5 
## Categorical characteristics: z1 z2 z3 z4 z5 grade3 
## CV lambda = 0.04396711 
## 12 x 1 sparse Matrix of class "dgCMatrix"
##                s0
## z1      .        
## z2      .        
## z3      .        
## z4      0.7509354
## z5     -0.9007276
## size    .        
## grade3  .        
## noise1  .        
## noise2  .        
## noise3  .        
## noise4  .        
## noise5  .        
## Cox-LASSO selected: z4 z5 
## Cox-LASSO not selected: z1 z2 z3 size grade3 noise1 noise2 noise3 noise4 noise5 
## Default cuts included from Lasso: 
## Categorical after Lasso: z4 z5 
## # of candidate subgroup factors= 22 
##  [1] "size <= 27.9"   "size <= 25"     "size <= 20"     "size <= 34"    
##  [5] "noise1 <= 0.1"  "noise1 <= -0.7" "noise1 <= 0.7"  "noise2 <= 0"   
##  [9] "noise2 <= -0.1" "noise2 <= -0.6" "noise2 <= 0.7"  "noise3 <= 0"   
## [13] "noise3 <= -0.7" "noise3 <= 0.7"  "noise4 <= 0"    "noise4 <= -0.8"
## [17] "noise4 <= 0.7"  "noise5 <= 0.1"  "noise5 <= -0.5" "noise5 <= 0.8" 
## [21] "z4"             "z5"            
## Number of factors evaluated= 22 
## Confounders per grf screening q21 q1 q2 q16 q22 q15 q18 q5 q20 q12 q3 q8 q6 q7 q9 q4 q14 q19 q11 q13 q10 q17 
##           Factors Labels VI(grf)
## 21             z4    q21  0.1197
## 1    size <= 27.9     q1  0.0803
## 2      size <= 25     q2  0.0719
## 16 noise4 <= -0.8    q16  0.0685
## 22             z5    q22  0.0659
## 15    noise4 <= 0    q15  0.0602
## 18  noise5 <= 0.1    q18  0.0529
## 5   noise1 <= 0.1     q5  0.0505
## 20  noise5 <= 0.8    q20  0.0493
## 12    noise3 <= 0    q12  0.0427
## 3      size <= 20     q3  0.0387
## 8     noise2 <= 0     q8  0.0346
## 6  noise1 <= -0.7     q6  0.0313
## 7   noise1 <= 0.7     q7  0.0302
## 9  noise2 <= -0.1     q9  0.0287
## 4      size <= 34     q4  0.0278
## 14  noise3 <= 0.7    q14  0.0273
## 19 noise5 <= -0.5    q19  0.0273
## 11  noise2 <= 0.7    q11  0.0248
## 13 noise3 <= -0.7    q13  0.0246
## 10 noise2 <= -0.6    q10  0.0232
## 17  noise4 <= 0.7    q17  0.0196
## Number of possible configurations (<= maxk): maxk, # <= maxk 2 990 
## Approximately 5% of max_count met: minutes 0.002233333 
## Approximately 10% of max_count met: minutes 0.0036 
## Approximately 20% of max_count met: minutes 0.007033333 
## Approximately 33% of max_count met: minutes 0.01148333 
## Approximately 50% of max_count met: minutes 0.01623333 
## Approximately 75% of max_count met: minutes 0.02393333 
## Approximately 90% of max_count met: minutes 0.02735 
## # of subgroups evaluated based on (up to) maxk-factor combinations 990 
## % of all-possible combinations (<= maxk) 100 
## k.max= 2 
## Events criteria for control,exp= 10 10 
## # of subgroups with events less than criteria: control, experimental 160 313 
## # of subgroups with sample size less than criteria 417 
## # of subgroups meeting all criteria = 537 
## # of subgroups fitted (Cox model estimable) = 537 
## *Subgroup Searching Minutes=* 0.02943333 
## Number of subgroups meeting HR threshold 0 
## NO subgroup candidate found (FS) 
## FS: GRF stage for cut selection with dmin,tau= 12 0.6 
## tau, maxdepth= 45.42348 2 
##    leaf.node control.mean control.size control.se depth
## 2          3        -6.97       291.00       1.49     1
## 21         5       -14.58        77.00       2.86     2
## 3          6         6.45        63.00       2.91     2
## 4          7        -9.23       144.00       2.02     2
##   leaf.node control.mean control.size control.se depth
## 3         6         6.45        63.00       2.91     2
## GRF subgroup found 
## All splits 
## [1] "noise5 <= -0.51" "noise3 <= -0.7"  "noise5 <= 0.01" 
## Terminating node at max.diff (sg.harm.id) 
## [1] "noise5 <= 0.00807090609630402"
## # of continuous/categorical characteristics 6 6 
## Continuous characteristics: size noise1 noise2 noise3 noise4 noise5 
## Categorical characteristics: z1 z2 z3 z4 z5 grade3 
## Default cuts included (1st 20) 
## Categorical: z1 z2 z3 z4 z5 grade3 
## Factors per GRF: noise5 <= -0.51 noise3 <= -0.7 noise5 <= 0.01 
## Initial GRF cuts included noise5 <= -0.51 noise3 <= -0.7 noise5 <= 0.01 
## # of candidate subgroup factors= 30 
##  [1] "noise5 <= -0.51" "noise3 <= -0.7"  "noise5 <= 0.01"  "size <= 29.7"   
##  [5] "size <= 27"      "size <= 21"      "size <= 35"      "noise1 <= -0.1" 
##  [9] "noise1 <= -0.8"  "noise1 <= 0.7"   "noise2 <= -0.1"  "noise2 <= -0.8" 
## [13] "noise2 <= 0.5"   "noise3 <= 0.1"   "noise3 <= 0"     "noise3 <= -0.6" 
## [17] "noise3 <= 0.8"   "noise4 <= 0.1"   "noise4 <= 0"     "noise4 <= -0.6" 
## [21] "noise4 <= 0.8"   "noise5 <= 0"     "noise5 <= -0.7"  "noise5 <= 0.7"  
## [25] "z1"              "z2"              "z3"              "z4"             
## [29] "z5"              "grade3"         
## Number of factors evaluated= 30 
## Confounders per grf screening q28 q3 q25 q30 q22 q1 q19 q29 q26 q11 q12 q8 q5 q23 q2 q16 q6 q18 q27 q4 q14 q17 q24 q13 q9 q15 q20 q21 q10 q7 
##            Factors Labels VI(grf)
## 28              z4    q28  0.1662
## 3   noise5 <= 0.01     q3  0.0948
## 25              z1    q25  0.0595
## 30          grade3    q30  0.0417
## 22     noise5 <= 0    q22  0.0416
## 1  noise5 <= -0.51     q1  0.0410
## 19     noise4 <= 0    q19  0.0396
## 29              z5    q29  0.0379
## 26              z2    q26  0.0366
## 11  noise2 <= -0.1    q11  0.0331
## 12  noise2 <= -0.8    q12  0.0325
## 8   noise1 <= -0.1     q8  0.0296
## 5       size <= 27     q5  0.0271
## 23  noise5 <= -0.7    q23  0.0247
## 2   noise3 <= -0.7     q2  0.0243
## 16  noise3 <= -0.6    q16  0.0242
## 6       size <= 21     q6  0.0230
## 18   noise4 <= 0.1    q18  0.0217
## 27              z3    q27  0.0212
## 4     size <= 29.7     q4  0.0205
## 14   noise3 <= 0.1    q14  0.0204
## 17   noise3 <= 0.8    q17  0.0196
## 24   noise5 <= 0.7    q24  0.0183
## 13   noise2 <= 0.5    q13  0.0173
## 9   noise1 <= -0.8     q9  0.0172
## 15     noise3 <= 0    q15  0.0172
## 20  noise4 <= -0.6    q20  0.0160
## 21   noise4 <= 0.8    q21  0.0147
## 10   noise1 <= 0.7    q10  0.0108
## 7       size <= 35     q7  0.0079
## Number of possible configurations (<= maxk): maxk, # <= maxk 2 1830 
## Approximately 5% of max_count met: minutes 0.005316667 
## Approximately 10% of max_count met: minutes 0.008333333 
## Approximately 20% of max_count met: minutes 0.01756667 
## Approximately 33% of max_count met: minutes 0.02496667 
## Approximately 50% of max_count met: minutes 0.03443333 
## Approximately 75% of max_count met: minutes 0.04885 
## Approximately 90% of max_count met: minutes 0.0554 
## # of subgroups evaluated based on (up to) maxk-factor combinations 1830 
## % of all-possible combinations (<= maxk) 100 
## k.max= 2 
## Events criteria for control,exp= 10 10 
## # of subgroups with events less than criteria: control, experimental 321 496 
## # of subgroups with sample size less than criteria 754 
## # of subgroups meeting all criteria = 1004 
## # of subgroups fitted (Cox model estimable) = 1004 
## *Subgroup Searching Minutes=* 0.05971667 
## Number of subgroups meeting HR threshold 6 
## Subgroup candidate(s) found (FS) 
## # of candidate subgroups (meeting HR criteria) =  6 
## SGs (1st 10) meeting screening thresholds sorted by sg_focus= hr 
##    n  E d1   HR L(HR) q28.0 q28.1 q3.0 q3.1 q25.0 q25.1
## 1 64 29 17 1.63  0.77     0     0    0    1     0     0
## 2 62 28 17 1.60  0.75     0     0    0    0     0     0
## 3 81 38 21 1.30  0.68     0     0    0    1     0     0
## 4 75 36 20 1.28  0.66     0     0    0    1     0     0
## 5 79 37 21 1.27  0.66     0     0    0    0     0     0
## 6 65 35 18 1.26  0.65     0     0    0    0     0     0
## Consistency 0.83 
## Consistency 0.77 
## Consistency 0.5425 
## Subgroup Consistency Minutes= 0.09938333 
## NO subgroup found (FS) 
## Minutes forestsearch overall= 0.1663833 
## FS: GRF stage for cut selection with dmin,tau= 12 0.6 
## tau, maxdepth= 45.42348 2 
##    leaf.node control.mean control.size control.se depth
## 2          3        -6.97       291.00       1.49     1
## 21         5       -14.58        77.00       2.86     2
## 3          6         6.45        63.00       2.91     2
## 4          7        -9.23       144.00       2.02     2
##   leaf.node control.mean control.size control.se depth
## 3         6         6.45        63.00       2.91     2
## GRF subgroup found 
## All splits 
## [1] "noise5 <= -0.51" "noise3 <= -0.7"  "noise5 <= 0.01" 
## Terminating node at max.diff (sg.harm.id) 
## [1] "noise5 <= 0.00807090609630402"
## # of continuous/categorical characteristics 6 6 
## Continuous characteristics: size noise1 noise2 noise3 noise4 noise5 
## Categorical characteristics: z1 z2 z3 z4 z5 grade3 
## CV lambda = 0.04541205 
## 12 x 1 sparse Matrix of class "dgCMatrix"
##                s0
## z1      .        
## z2      .        
## z3      .        
## z4      0.7803413
## z5     -0.6626916
## size    .        
## grade3  .        
## noise1  0.0240149
## noise2  .        
## noise3  .        
## noise4  .        
## noise5  .        
## Cox-LASSO selected: z4 z5 noise1 
## Cox-LASSO not selected: z1 z2 z3 size grade3 noise2 noise3 noise4 noise5 
## Default cuts included from Lasso: 
## Categorical after Lasso: z4 z5 
## Factors per GRF: noise5 <= -0.51 noise3 <= -0.7 noise5 <= 0.01 
## Initial GRF cuts included noise5 <= -0.51 noise3 <= -0.7 noise5 <= 0.01 
## Factors included per GRF (not in lasso) noise5 <= -0.51 noise3 <= -0.7 noise5 <= 0.01 
## # of candidate subgroup factors= 26 
##  [1] "noise5 <= -0.51" "noise3 <= -0.7"  "noise5 <= 0.01"  "size <= 29.7"   
##  [5] "size <= 27"      "size <= 21"      "size <= 35"      "noise1 <= -0.1" 
##  [9] "noise1 <= -0.8"  "noise1 <= 0.7"   "noise2 <= -0.1"  "noise2 <= -0.8" 
## [13] "noise2 <= 0.5"   "noise3 <= 0.1"   "noise3 <= 0"     "noise3 <= -0.6" 
## [17] "noise3 <= 0.8"   "noise4 <= 0.1"   "noise4 <= 0"     "noise4 <= -0.6" 
## [21] "noise4 <= 0.8"   "noise5 <= 0"     "noise5 <= -0.7"  "noise5 <= 0.7"  
## [25] "z4"              "z5"             
## Number of factors evaluated= 26 
## Confounders per grf screening q25 q3 q19 q22 q26 q1 q11 q8 q16 q12 q5 q2 q23 q17 q18 q6 q14 q15 q4 q24 q13 q9 q20 q21 q10 q7 
##            Factors Labels VI(grf)
## 25              z4    q25  0.2192
## 3   noise5 <= 0.01     q3  0.1034
## 19     noise4 <= 0    q19  0.0524
## 22     noise5 <= 0    q22  0.0482
## 26              z5    q26  0.0445
## 1  noise5 <= -0.51     q1  0.0443
## 11  noise2 <= -0.1    q11  0.0424
## 8   noise1 <= -0.1     q8  0.0375
## 16  noise3 <= -0.6    q16  0.0330
## 12  noise2 <= -0.8    q12  0.0328
## 5       size <= 27     q5  0.0311
## 2   noise3 <= -0.7     q2  0.0279
## 23  noise5 <= -0.7    q23  0.0263
## 17   noise3 <= 0.8    q17  0.0256
## 18   noise4 <= 0.1    q18  0.0255
## 6       size <= 21     q6  0.0246
## 14   noise3 <= 0.1    q14  0.0226
## 15     noise3 <= 0    q15  0.0220
## 4     size <= 29.7     q4  0.0213
## 24   noise5 <= 0.7    q24  0.0209
## 13   noise2 <= 0.5    q13  0.0204
## 9   noise1 <= -0.8     q9  0.0195
## 20  noise4 <= -0.6    q20  0.0161
## 21   noise4 <= 0.8    q21  0.0147
## 10   noise1 <= 0.7    q10  0.0140
## 7       size <= 35     q7  0.0099
## Number of possible configurations (<= maxk): maxk, # <= maxk 2 1378 
## Approximately 5% of max_count met: minutes 0.00415 
## Approximately 10% of max_count met: minutes 0.0074 
## Approximately 20% of max_count met: minutes 0.01336667 
## Approximately 33% of max_count met: minutes 0.02003333 
## Approximately 50% of max_count met: minutes 0.02795 
## Approximately 75% of max_count met: minutes 0.03698333 
## Approximately 90% of max_count met: minutes 0.04458333 
## # of subgroups evaluated based on (up to) maxk-factor combinations 1378 
## % of all-possible combinations (<= maxk) 100 
## k.max= 2 
## Events criteria for control,exp= 10 10 
## # of subgroups with events less than criteria: control, experimental 262 384 
## # of subgroups with sample size less than criteria 574 
## # of subgroups meeting all criteria = 741 
## # of subgroups fitted (Cox model estimable) = 741 
## *Subgroup Searching Minutes=* 0.04928333 
## Number of subgroups meeting HR threshold 6 
## Subgroup candidate(s) found (FS) 
## # of candidate subgroups (meeting HR criteria) =  6 
## SGs (1st 10) meeting screening thresholds sorted by sg_focus= hr 
##    n  E d1   HR L(HR) q25.0 q25.1 q3.0 q3.1 q19.0 q19.1
## 1 64 29 17 1.63  0.77     0     0    0    1     0     0
## 2 62 28 17 1.60  0.75     0     0    0    0     0     0
## 3 81 38 21 1.30  0.68     0     0    0    1     0     0
## 4 75 36 20 1.28  0.66     0     0    0    1     0     0
## 5 79 37 21 1.27  0.66     0     0    0    0     0     0
## 6 65 35 18 1.26  0.65     0     0    0    0     0     0
## Consistency 0.83 
## Consistency 0.77 
## Consistency 0.5425 
## Subgroup Consistency Minutes= 0.1055 
## NO subgroup found (FS) 
## Minutes forestsearch overall= 0.1648667
\end{verbatim}
\begin{alltt}
\hlstd{t.now} \hlkwb{<-} \hlkwd{proc.time}\hlstd{()[}\hlnum{3}\hlstd{]}
\hlstd{t.min} \hlkwb{<-} \hlstd{(t.now} \hlopt{-} \hlstd{t.start)}\hlopt{/}\hlnum{60}

\hlkwd{print}\hlstd{(}\hlkwd{table}\hlstd{(res}\hlopt{$}\hlstd{analysis))}
\end{alltt}
\begin{verbatim}
## 
##     FSl    FSlg     GRF  GRF.60  VT(24)  VT(36) VT#(24) VT#(36) 
##   20000   20000   20000   20000   20000   20000   20000   20000
\end{verbatim}
\begin{alltt}
\hlstd{check} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlkwd{c}\hlstd{(}\hlkwd{table}\hlstd{(res}\hlopt{$}\hlstd{analysis))} \hlopt{-} \hlstd{Nsims)}
\hlkwa{if} \hlstd{(}\hlkwd{all}\hlstd{(check} \hlopt{!=} \hlnum{0}\hlstd{))} \hlkwd{stop}\hlstd{(}\hlstr{"All analyses not complete"}\hlstd{)}

\hlstd{dgm_alt} \hlkwb{<-} \hlstd{dgm}
\hlstd{outres} \hlkwb{<-} \hlkwd{out.results}\hlstd{(}\hlkwc{res} \hlstd{= res,} \hlkwc{dgm} \hlstd{= dgm,} \hlkwc{output.file} \hlstd{= output.file,} \hlkwc{t.min} \hlstd{= t.min,}
    \hlkwc{out_analysis} \hlstd{=} \hlstr{"FSl"}\hlstd{)}
\end{alltt}
\begin{verbatim}
## [1] "results/oc_sims=20000_m4c-Noise=5_N=300_null_ktreat=1.5_v0-4cuts.Rdata"
##      sim sizeH_true propH_true sizeHc_true propHc_true any.H size.H size.Hc
##    <int>      <num>      <num>       <int>       <num> <num>  <num>   <int>
## 1:     1          0          0         300           1     0      0     300
## 2:     1          0          0         300           1     0      0     300
## 3:     1          0          0         300           1     0      0     300
## 4:     1          0          0         300           1     0      0     300
## 5:     1          0          0         300           1     0      0     300
## 6:     1          0          0         300           1     0      0     300
##       ppv   npv specificity sensitivity found.1 found.2 found.both found.al3
##    <lgcl> <num>       <num>       <num>   <int>   <int>      <num>     <num>
## 1:     NA     1           1          NA       0       0          0         0
## 2:     NA     1           1          NA       0       0          0         0
## 3:     NA     1           1          NA      NA      NA         NA        NA
## 4:     NA     1           1          NA      NA      NA         NA        NA
## 5:     NA     1           1          NA       0       0          0         0
## 6:     NA     1           1          NA       0       0          0         0
##    hr.H.true hr.Hc.true hr.H.hat hr.Hc.hat   b1.H   b2.H b1.Hc      b2.Hc
##       <lgcl>      <num>    <num>     <num> <lgcl> <lgcl> <num>      <num>
## 1:        NA  0.6000708       NA 0.6000708     NA     NA     0 0.04834743
## 2:        NA  0.6000708       NA 0.6000708     NA     NA     0 0.04834743
## 3:        NA  0.6000708       NA 0.6000708     NA     NA     0 0.04834743
## 4:        NA  0.6000708       NA 0.6000708     NA     NA     0 0.04834743
## 5:        NA  0.6000708       NA 0.6000708     NA     NA     0 0.04834743
## 6:        NA  0.6000708       NA 0.6000708     NA     NA     0 0.04834743
##    p.cens analysis   taumax    hr.itt     l.itt     u.itt hr.adj.itt l.adj.itt
##     <num>   <char>    <num>     <num>     <num>     <num>      <num>     <num>
## 1:   0.45      FSl 75.55189 0.6000708 0.4404799 0.8174834  0.5166355   0.37681
## 2:   0.45     FSlg 45.33113 0.6000708 0.4404799 0.8174834  0.5166355   0.37681
## 3:   0.45      GRF 75.55189 0.6000708 0.4404799 0.8174834  0.5166355   0.37681
## 4:   0.45   GRF.60 45.33113 0.6000708 0.4404799 0.8174834  0.5166355   0.37681
## 5:   0.45   VT(24) 75.55189 0.6000708 0.4404799 0.8174834  0.5166355   0.37681
## 6:   0.45  VT#(24) 75.55189 0.6000708 0.4404799 0.8174834  0.5166355   0.37681
##    u.adj.itt l.H.true u.H.true l.Hc.true u.Hc.true l.H.hat u.H.hat  l.Hc.hat
##        <num>   <lgcl>   <lgcl>     <num>     <num>   <num>   <num>     <num>
## 1:  0.708347       NA       NA 0.4404799 0.8174834      NA      NA 0.4404799
## 2:  0.708347       NA       NA 0.4404799 0.8174834      NA      NA 0.4404799
## 3:  0.708347       NA       NA 0.4404799 0.8174834      NA      NA 0.4404799
## 4:  0.708347       NA       NA 0.4404799 0.8174834      NA      NA 0.4404799
## 5:  0.708347       NA       NA 0.4404799 0.8174834      NA      NA 0.4404799
## 6:  0.708347       NA       NA 0.4404799 0.8174834      NA      NA 0.4404799
##     u.Hc.hat
##        <num>
## 1: 0.8174834
## 2: 0.8174834
## 3: 0.8174834
## 4: 0.8174834
## 5: 0.8174834
## 6: 0.8174834
## Subgroup HRs: H, H^c, Causal= NA 0.5517234 0.5517234 
## Simulations= 20000 
## Avg censoring= 0.501857 
## Min,Max,Avg tau.max= 59.38268 83.94994 78.95074 
## P(H) approximation at causal(Hrc), n=60, approx= 0.5517234 0.008107176 
## P(H) approximation at plim(Hrc), n=60, approx= 0.5427458 0.007193425 
## Minutes,hours 93.4978 1.558297 
##                    FSl    FSlg     GRF  GRF.60  VT(24) VT#(24)  VT(36) VT#(36)
## any.H            0.040   0.040   0.130   0.070   0.010   0.000   0.020   0.010
## sensH              NaN     NaN     NaN     NaN     NaN     NaN     NaN     NaN
## sensHc           0.990   0.990   0.970   0.980   1.000   1.000   0.990   1.000
## ppH              0.000   0.000   0.000   0.000   0.000   0.000   0.000   0.000
## ppHc             1.000   1.000   1.000   1.000   1.000   1.000   1.000   1.000
## Avg(#H)         73.000  73.000  74.000  71.000  71.000  69.000  74.000  70.000
## minH            61.000  61.000  60.000  60.000  60.000  60.000  60.000  60.000
## maxH           150.000 150.000 160.000 136.000 125.000 102.000 138.000 125.000
## Avg(#Hc)       297.000 297.000 291.000 295.000 299.000 300.000 298.000 300.000
## minHc          150.000 150.000 140.000 164.000 175.000 198.000 162.000 175.000
## maxHc          300.000 300.000 300.000 300.000 300.000 300.000 300.000 300.000
## hat(H*)            NaN     NaN     NaN     NaN     NaN     NaN     NaN     NaN
## hat(hat[H])      1.991   1.992   1.726   1.515   1.095   1.283   1.130   1.496
## hat(Hc*)         0.693   0.697   0.636   0.622   0.607   0.632   0.614   0.638
## hat(hat[Hc])     0.499   0.502   0.460   0.474   0.513   0.513   0.511   0.497
## hat(H*)all         NaN     NaN     NaN     NaN     NaN     NaN     NaN     NaN
## hat(Hc*)all      0.543   0.543   0.543   0.543   0.543   0.543   0.543   0.543
## hat(ITT)all      0.543   0.543   0.543   0.543   0.543   0.543   0.543   0.543
## hat(ITTadj)all   0.488   0.488   0.488   0.488   0.488   0.488   0.488   0.488
\end{verbatim}
\begin{alltt}
\hlstd{missC} \hlkwb{<-} \hlkwd{tab_tests}\hlstd{(}\hlkwc{res} \hlstd{= res)}

\hlstd{pA} \hlkwb{<-} \hlkwd{as.character}\hlstd{(}\hlkwd{round}\hlstd{(outres}\hlopt{$}\hlstd{pAnyH.approx2,} \hlnum{4}\hlstd{))}
\hlstd{tabsim_missC} \hlkwb{<-} \hlkwd{get_tabsim}\hlstd{(}\hlkwc{missC} \hlstd{= missC,} \hlkwc{pA} \hlstd{= pA,} \hlkwc{est_names} \hlstd{= est_names,} \hlkwc{stat_names} \hlstd{= stat_names,}
    \hlkwc{mod.harm} \hlstd{= mod.harm,} \hlkwc{Nsims} \hlstd{= Nsims)}
\end{alltt}
\end{kframe}
\end{knitrout}

\begin{table}[!h]
\centering
\caption{\label{tab:r null}Average classification rates: ${avg}\vert \hat{H} \vert$, ${min}\vert \hat{H} \vert$, and ${max}\vert \hat{H} \vert$, denote the average, 
minimum, and maximum of the number of subjects in the estimated subgroup $\hat{H}$ (analogously for $\hat{H}^{c}$).  
Note that under the null $sens(\hat{H})$ is undefined and $ppv(\hat{H})=0$.}
\centering
\fontsize{9}{11}\selectfont
\begin{tabular}[t]{lcccccccc}
\toprule
  & $FS_{g}$ & $FS_{lg}$ & $GRF$ & $GRF_{60}$ & $VT(24)$ & ${VT}^{\#}(24)$ & $VT(36)$ & ${VT}^{\#}(36)$\\
\midrule
\addlinespace[0.3em]
\multicolumn{9}{l}{\textbf{Finding H}}\\
\hspace{1em}any(H) & 0.04 & 0.04 & 0.13 & 0.07 & 0.01 & 0 & 0.02 & 0.01\\
\hspace{1em}${sens}(\hat{H})$ & . & . & . & . & . & . & . & .\\
\hspace{1em}${sens}(\hat{H}^{C})$ & 0.99 & 0.99 & 0.97 & 0.98 & 1 & 1 & 0.99 & 1\\
\hspace{1em}${ppv}(\hat{H})$ & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
\hspace{1em}${ppv}(\hat{H}^{C})$ & 1 & 1 & 1 & 1 & 1 & 1 & 1 & 1\\
\addlinespace[0.3em]
\multicolumn{9}{l}{\textbf{Size of H and H-complement}}\\
\hspace{1em}${avg}\vert \hat{H} \vert$ & 73 & 73 & 74 & 71 & 71 & 69 & 74 & 70\\
\hspace{1em}${min}\vert \hat{H} \vert$ & 61 & 61 & 60 & 60 & 60 & 60 & 60 & 60\\
\hspace{1em}${max}\vert \hat{H} \vert$ & 150 & 150 & 160 & 136 & 125 & 102 & 138 & 125\\
\hspace{1em}${avg}\vert \hat{H}^{C} \vert$ & 297 & 297 & 291 & 295 & 299 & 300 & 298 & 300\\
\hspace{1em}${min}\vert \hat{H}^{C} \vert$ & 150 & 150 & 140 & 164 & 175 & 198 & 162 & 175\\
\hspace{1em}${max}\vert \hat{H}^{C} \vert$ & 300 & 300 & 300 & 300 & 300 & 300 & 300 & 300\\
\bottomrule
\multicolumn{9}{l}{\rule{0pt}{1em}\textit{Note: } Number of simulations= 20000 .}\\
\multicolumn{9}{l}{\rule{0pt}{1em}\textit{Note: } Probability approximation= 0.0072 .}\\
\end{tabular}
\end{table}




\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{mod.harm} \hlkwb{<-} \hlstr{"alt"}
\hlstd{hrH.target} \hlkwb{<-} \hlnum{2}

\hlstd{this.dgm} \hlkwb{<-} \hlkwd{get.dgm4.OC}\hlstd{(}\hlkwc{mod.harm} \hlstd{= mod.harm,} \hlkwc{N} \hlstd{= N,} \hlkwc{k.treat} \hlstd{= k.treat,} \hlkwc{model.index} \hlstd{= model.index,}
    \hlkwc{sol_tol} \hlstd{=} \hlnum{10}\hlopt{^-}\hlnum{8}\hlstd{,} \hlkwc{hrH.target} \hlstd{= hrH.target,} \hlkwc{cens.type} \hlstd{= cens.type,} \hlkwc{out.loc} \hlstd{= out.loc,}
    \hlkwc{file.index} \hlstd{= file.index,} \hlkwc{details} \hlstd{=} \hlnum{TRUE}\hlstd{,} \hlkwc{parms_torand} \hlstd{=} \hlnum{FALSE}\hlstd{)}
\end{alltt}
\end{kframe}
\includegraphics[width=\maxwidth]{figure/r_hrh2-1} 
\begin{kframe}\begin{verbatim}
## Super-population empirical harm and non-harm hazard ratios= 1.999999 0.557631 
## Causal HR (empirical ITT)= 0.7363833
\end{verbatim}
\begin{alltt}
\hlstd{dgm} \hlkwb{<-} \hlstd{this.dgm}\hlopt{$}\hlstd{dgm}
\hlstd{output.file} \hlkwb{<-} \hlstd{this.dgm}\hlopt{$}\hlstd{out.file}

\hlkwa{if} \hlstd{(}\hlopt{!}\hlkwd{is.null}\hlstd{(output.file)} \hlopt{& !}\hlkwd{grepl}\hlstd{(mod.harm, output.file))} \hlkwd{stop}\hlstd{(}\hlstr{"Wrong file name for mod.harm"}\hlstd{)}

\hlcom{# Show first simulation ans1 <- oc_analyses_m4_FS4(2)}

\hlstd{t.start} \hlkwb{<-} \hlkwd{proc.time}\hlstd{()[}\hlnum{3}\hlstd{]}
\hlstd{res} \hlkwb{<-} \hlkwd{foreach}\hlstd{(}\hlkwc{sim} \hlstd{=} \hlkwd{seq_len}\hlstd{(Nsims),} \hlkwc{.options.future} \hlstd{=} \hlkwd{list}\hlstd{(}\hlkwc{seed} \hlstd{=} \hlnum{TRUE}\hlstd{),} \hlkwc{.combine} \hlstd{=} \hlstr{"rbind"}\hlstd{,}
    \hlkwc{.errorhandling} \hlstd{=} \hlstr{"pass"}\hlstd{)} \hlopt{%dofuture%} \hlstd{\{}
    \hlstd{ans} \hlkwb{<-} \hlkwd{oc_analyses_m4FourCuts_FS4}\hlstd{(sim)}
    \hlkwd{return}\hlstd{(ans)}
\hlstd{\}}
\end{alltt}
\begin{verbatim}
## FS: GRF stage for cut selection with dmin,tau= 12 0.6 
## tau, maxdepth= 49.06126 2 
##   leaf.node control.mean control.size control.se depth
## 1         2        -2.85       256.00       1.95     1
## 2         5         7.97        82.00       3.50     2
## 3         6        -7.10       146.00       2.45     2
##   leaf.node control.mean control.size control.se depth
## 2         5         7.97        82.00       3.50     2
## GRF subgroup found 
## All splits 
## [1] "noise5 <= -0.4"  "noise2 <= -0.77" "noise5 <= 1.07" 
## Terminating node at max.diff (sg.harm.id) 
## [1] "noise2 <= -0.768600960339892"
## # of continuous/categorical characteristics 6 6 
## Continuous characteristics: size noise1 noise2 noise3 noise4 noise5 
## Categorical characteristics: z1 z2 z3 z4 z5 grade3 
## Default cuts included (1st 20) 
## Categorical: z1 z2 z3 z4 z5 grade3 
## Factors per GRF: noise5 <= -0.4 noise2 <= -0.77 noise5 <= 1.07 
## Initial GRF cuts included noise5 <= -0.4 noise2 <= -0.77 noise5 <= 1.07 
## # of candidate subgroup factors= 28 
##  [1] "noise5 <= -0.4"  "noise2 <= -0.77" "noise5 <= 1.07"  "size <= 29.6"   
##  [5] "size <= 25"      "size <= 21"      "size <= 35"      "noise1 <= 0"    
##  [9] "noise1 <= -0.6"  "noise1 <= 0.7"   "noise2 <= 0"     "noise2 <= -0.7" 
## [13] "noise2 <= 0.7"   "noise3 <= 0"     "noise3 <= -0.7"  "noise3 <= 0.8"  
## [17] "noise4 <= 0"     "noise4 <= -0.8"  "noise4 <= 0.7"   "noise5 <= -0.1" 
## [21] "noise5 <= -0.8"  "noise5 <= 0.5"   "z1"              "z2"             
## [25] "z3"              "z4"              "z5"              "grade3"         
## Number of factors evaluated= 28 
## Confounders per grf screening q6 q25 q7 q3 q24 q23 q22 q19 q1 q27 q4 q14 q26 q5 q11 q8 q17 q20 q21 q15 q10 q13 q12 q9 q16 q28 q18 q2 
##            Factors Labels VI(grf)
## 6       size <= 21     q6  0.1003
## 25              z3    q25  0.0794
## 7       size <= 35     q7  0.0733
## 3   noise5 <= 1.07     q3  0.0687
## 24              z2    q24  0.0653
## 23              z1    q23  0.0463
## 22   noise5 <= 0.5    q22  0.0453
## 19   noise4 <= 0.7    q19  0.0404
## 1   noise5 <= -0.4     q1  0.0389
## 27              z5    q27  0.0365
## 4     size <= 29.6     q4  0.0359
## 14     noise3 <= 0    q14  0.0345
## 26              z4    q26  0.0334
## 5       size <= 25     q5  0.0311
## 11     noise2 <= 0    q11  0.0304
## 8      noise1 <= 0     q8  0.0298
## 17     noise4 <= 0    q17  0.0295
## 20  noise5 <= -0.1    q20  0.0288
## 21  noise5 <= -0.8    q21  0.0227
## 15  noise3 <= -0.7    q15  0.0193
## 10   noise1 <= 0.7    q10  0.0189
## 13   noise2 <= 0.7    q13  0.0166
## 12  noise2 <= -0.7    q12  0.0161
## 9   noise1 <= -0.6     q9  0.0158
## 16   noise3 <= 0.8    q16  0.0143
## 28          grade3    q28  0.0106
## 18  noise4 <= -0.8    q18  0.0103
## 2  noise2 <= -0.77     q2  0.0076
## Number of possible configurations (<= maxk): maxk, # <= maxk 2 1596 
## Approximately 5% of max_count met: minutes 0.0028 
## Approximately 10% of max_count met: minutes 0.004083333 
## Approximately 20% of max_count met: minutes 0.006516667 
## Approximately 33% of max_count met: minutes 0.01075 
## Approximately 50% of max_count met: minutes 0.0155 
## Approximately 75% of max_count met: minutes 0.02465 
## Approximately 90% of max_count met: minutes 0.02916667 
## # of subgroups evaluated based on (up to) maxk-factor combinations 1596 
## % of all-possible combinations (<= maxk) 100 
## k.max= 2 
## Events criteria for control,exp= 10 10 
## # of subgroups with events less than criteria: control, experimental 252 309 
## # of subgroups with sample size less than criteria 713 
## # of subgroups meeting all criteria = 855 
## # of subgroups fitted (Cox model estimable) = 855 
## *Subgroup Searching Minutes=* 0.03105 
## Number of subgroups meeting HR threshold 49 
## Subgroup candidate(s) found (FS) 
## # of candidate subgroups (meeting HR criteria) =  49 
## SGs (1st 10) meeting screening thresholds sorted by sg_focus= hr 
##     n  E d1   HR L(HR) q6.0 q6.1 q25.0 q25.1 q7.0 q7.1 q3.0 q3.1 q24.0 q24.1
## 1  67 42 22 1.89  1.03    0    0     0     0    1    0    0    0     0     0
## 2  67 42 22 1.89  1.03    1    0     0     0    1    0    0    0     0     0
## 3  63 42 20 1.80  0.98    0    0     0     0    0    0    0    0     0     0
## 4  72 45 25 1.71  0.95    0    0     0     0    0    0    0    0     0     1
## 5  70 43 28 1.69  0.90    0    0     0     0    0    0    0    0     0     0
## 6  69 41 23 1.56  0.84    0    0     0     0    0    0    0    0     0     0
## 7  80 60 31 1.56  0.94    0    0     0     1    0    0    0    0     0     0
## 8  74 58 29 1.52  0.90    0    0     0     0    0    0    0    0     0     1
## 9  78 57 31 1.48  0.88    0    0     0     0    0    0    0    0     0     0
## 10 61 37 19 1.48  0.77    0    0     0     0    0    0    0    0     0     0
## Consistency 0.95 
## # of splits= 400 
## Model, % Consistency Met= !{size <= 35} 0.95 
## SG focus= hr 
## Subgroup Consistency Minutes= 0.02448333 
## Subgroup found (FS) 
## Minutes forestsearch overall= 0.06066667 
## FS: GRF stage for cut selection with dmin,tau= 12 0.6 
## tau, maxdepth= 49.06126 2 
##   leaf.node control.mean control.size control.se depth
## 1         2        -2.85       256.00       1.95     1
## 2         5         7.97        82.00       3.50     2
## 3         6        -7.10       146.00       2.45     2
##   leaf.node control.mean control.size control.se depth
## 2         5         7.97        82.00       3.50     2
## GRF subgroup found 
## All splits 
## [1] "noise5 <= -0.4"  "noise2 <= -0.77" "noise5 <= 1.07" 
## Terminating node at max.diff (sg.harm.id) 
## [1] "noise2 <= -0.768600960339892"
## # of continuous/categorical characteristics 6 6 
## Continuous characteristics: size noise1 noise2 noise3 noise4 noise5 
## Categorical characteristics: z1 z2 z3 z4 z5 grade3 
## CV lambda = 0.03751062 
## 12 x 1 sparse Matrix of class "dgCMatrix"
##                 s0
## z1      0.06313344
## z2      .         
## z3      0.28641313
## z4      0.57548664
## z5     -0.61782376
## size    .         
## grade3  .         
## noise1  .         
## noise2 -0.06786117
## noise3  .         
## noise4  .         
## noise5  .         
## Cox-LASSO selected: z1 z3 z4 z5 noise2 
## Cox-LASSO not selected: z2 size grade3 noise1 noise3 noise4 noise5 
## Default cuts included from Lasso: 
## Categorical after Lasso: z1 z3 z4 z5 
## Factors per GRF: noise5 <= -0.4 noise2 <= -0.77 noise5 <= 1.07 
## Initial GRF cuts included noise5 <= -0.4 noise2 <= -0.77 noise5 <= 1.07 
## Factors included per GRF (not in lasso) noise5 <= -0.4 noise2 <= -0.77 noise5 <= 1.07 
## # of candidate subgroup factors= 26 
##  [1] "noise5 <= -0.4"  "noise2 <= -0.77" "noise5 <= 1.07"  "size <= 29.6"   
##  [5] "size <= 25"      "size <= 21"      "size <= 35"      "noise1 <= 0"    
##  [9] "noise1 <= -0.6"  "noise1 <= 0.7"   "noise2 <= 0"     "noise2 <= -0.7" 
## [13] "noise2 <= 0.7"   "noise3 <= 0"     "noise3 <= -0.7"  "noise3 <= 0.8"  
## [17] "noise4 <= 0"     "noise4 <= -0.8"  "noise4 <= 0.7"   "noise5 <= -0.1" 
## [21] "noise5 <= -0.8"  "noise5 <= 0.5"   "z1"              "z3"             
## [25] "z4"              "z5"             
## Number of factors evaluated= 26 
## Confounders per grf screening q24 q6 q7 q3 q23 q22 q1 q19 q4 q25 q8 q26 q14 q11 q17 q5 q20 q15 q9 q21 q10 q13 q12 q16 q18 q2 
##            Factors Labels VI(grf)
## 24              z3    q24  0.1086
## 6       size <= 21     q6  0.1004
## 7       size <= 35     q7  0.0713
## 3   noise5 <= 1.07     q3  0.0712
## 23              z1    q23  0.0556
## 22   noise5 <= 0.5    q22  0.0444
## 1   noise5 <= -0.4     q1  0.0416
## 19   noise4 <= 0.7    q19  0.0415
## 4     size <= 29.6     q4  0.0398
## 25              z4    q25  0.0366
## 8      noise1 <= 0     q8  0.0352
## 26              z5    q26  0.0352
## 14     noise3 <= 0    q14  0.0340
## 11     noise2 <= 0    q11  0.0335
## 17     noise4 <= 0    q17  0.0326
## 5       size <= 25     q5  0.0301
## 20  noise5 <= -0.1    q20  0.0285
## 15  noise3 <= -0.7    q15  0.0279
## 9   noise1 <= -0.6     q9  0.0205
## 21  noise5 <= -0.8    q21  0.0205
## 10   noise1 <= 0.7    q10  0.0199
## 13   noise2 <= 0.7    q13  0.0182
## 12  noise2 <= -0.7    q12  0.0143
## 16   noise3 <= 0.8    q16  0.0143
## 18  noise4 <= -0.8    q18  0.0135
## 2  noise2 <= -0.77     q2  0.0106
## Number of possible configurations (<= maxk): maxk, # <= maxk 2 1378 
## Approximately 5% of max_count met: minutes 0.00235 
## Approximately 10% of max_count met: minutes 0.0039 
## Approximately 20% of max_count met: minutes 0.0061 
## Approximately 33% of max_count met: minutes 0.00945 
## Approximately 50% of max_count met: minutes 0.01385 
## Approximately 75% of max_count met: minutes 0.0222 
## Approximately 90% of max_count met: minutes 0.02636667 
## # of subgroups evaluated based on (up to) maxk-factor combinations 1378 
## % of all-possible combinations (<= maxk) 100 
## k.max= 2 
## Events criteria for control,exp= 10 10 
## # of subgroups with events less than criteria: control, experimental 223 257 
## # of subgroups with sample size less than criteria 612 
## # of subgroups meeting all criteria = 739 
## # of subgroups fitted (Cox model estimable) = 739 
## *Subgroup Searching Minutes=* 0.02791667 
## Number of subgroups meeting HR threshold 41 
## Subgroup candidate(s) found (FS) 
## # of candidate subgroups (meeting HR criteria) =  41 
## SGs (1st 10) meeting screening thresholds sorted by sg_focus= hr 
##     n  E d1   HR L(HR) q24.0 q24.1 q6.0 q6.1 q7.0 q7.1 q3.0 q3.1 q23.0 q23.1
## 1  67 42 22 1.89  1.03     0     0    0    0    1    0    0    0     0     0
## 2  67 42 22 1.89  1.03     0     0    1    0    1    0    0    0     0     0
## 3  63 42 20 1.80  0.98     0     0    0    0    0    0    0    0     0     1
## 4  70 43 28 1.69  0.90     0     0    0    0    0    0    0    0     0     0
## 5  69 41 23 1.56  0.84     0     0    0    0    0    0    0    0     0     0
## 6  80 60 31 1.56  0.94     0     1    0    0    0    0    0    0     0     1
## 7  78 57 31 1.48  0.88     0     0    0    0    0    0    0    0     0     0
## 8  61 37 19 1.48  0.77     0     0    0    0    0    0    0    0     0     0
## 9  74 42 24 1.47  0.79     0     0    0    0    0    0    0    0     0     0
## 10 61 40 20 1.43  0.76     0     1    0    0    0    0    0    0     0     0
## Consistency 0.95 
## # of splits= 400 
## Model, % Consistency Met= !{size <= 35} 0.95 
## SG focus= hr 
## Subgroup Consistency Minutes= 0.0232 
## Subgroup found (FS) 
## Minutes forestsearch overall= 0.05636667 
## FS: GRF stage for cut selection with dmin,tau= 12 0.6 
## tau, maxdepth= 47.98043 2 
##    leaf.node control.mean control.size control.se depth
## 1          2        -3.81       170.00       2.10     1
## 2          3         4.92       130.00       2.58     1
## 11         4        -8.26        80.00       2.96     2
## 4          7         7.43       114.00       2.72     2
##   leaf.node control.mean control.size control.se depth
## 4         7         7.43       114.00       2.72     2
## GRF subgroup found 
## All splits 
## [1] "z2 <= 0"        "noise4 <= 0.29" "z1 <= 0"       
## Terminating node at max.diff (sg.harm.id) 
## [1] "z1 <= 0"
## # of continuous/categorical characteristics 6 6 
## Continuous characteristics: size noise1 noise2 noise3 noise4 noise5 
## Categorical characteristics: z1 z2 z3 z4 z5 grade3 
## Default cuts included (1st 20) 
## Categorical: z1 z2 z3 z4 z5 grade3 
## Factors per GRF: z2 <= 0 noise4 <= 0.29 z1 <= 0 
## Initial GRF cuts included z2 <= 0 noise4 <= 0.29 z1 <= 0 
## # of candidate subgroup factors= 27 
##  [1] "noise4 <= 0.29" "size <= 27.9"   "size <= 25"     "size <= 20"    
##  [5] "size <= 34"     "noise1 <= 0.1"  "noise1 <= -0.7" "noise1 <= 0.7" 
##  [9] "noise2 <= 0"    "noise2 <= -0.1" "noise2 <= -0.6" "noise2 <= 0.7" 
## [13] "noise3 <= 0"    "noise3 <= -0.7" "noise3 <= 0.7"  "noise4 <= 0"   
## [17] "noise4 <= -0.8" "noise4 <= 0.7"  "noise5 <= 0.1"  "noise5 <= -0.5"
## [21] "noise5 <= 0.8"  "z1"             "z2"             "z3"            
## [25] "z4"             "z5"             "grade3"        
## Number of factors evaluated= 27 
## Confounders per grf screening q24 q17 q22 q3 q2 q1 q15 q6 q14 q26 q25 q4 q21 q23 q16 q13 q19 q5 q12 q10 q9 q27 q20 q8 q7 q11 q18 
##           Factors Labels VI(grf)
## 24             z3    q24  0.0991
## 17 noise4 <= -0.8    q17  0.0654
## 22             z1    q22  0.0605
## 3      size <= 25     q3  0.0567
## 2    size <= 27.9     q2  0.0535
## 1  noise4 <= 0.29     q1  0.0471
## 15  noise3 <= 0.7    q15  0.0468
## 6   noise1 <= 0.1     q6  0.0444
## 14 noise3 <= -0.7    q14  0.0400
## 26             z5    q26  0.0397
## 25             z4    q25  0.0369
## 4      size <= 20     q4  0.0348
## 21  noise5 <= 0.8    q21  0.0338
## 23             z2    q23  0.0318
## 16    noise4 <= 0    q16  0.0305
## 13    noise3 <= 0    q13  0.0304
## 19  noise5 <= 0.1    q19  0.0303
## 5      size <= 34     q5  0.0290
## 12  noise2 <= 0.7    q12  0.0275
## 10 noise2 <= -0.1    q10  0.0262
## 9     noise2 <= 0     q9  0.0237
## 27         grade3    q27  0.0237
## 20 noise5 <= -0.5    q20  0.0228
## 8   noise1 <= 0.7     q8  0.0217
## 7  noise1 <= -0.7     q7  0.0154
## 11 noise2 <= -0.6    q11  0.0145
## 18  noise4 <= 0.7    q18  0.0135
## Number of possible configurations (<= maxk): maxk, # <= maxk 2 1485 
## Approximately 5% of max_count met: minutes 0.0031 
## Approximately 10% of max_count met: minutes 0.005966667 
## Approximately 20% of max_count met: minutes 0.009433333 
## Approximately 33% of max_count met: minutes 0.01551667 
## Approximately 50% of max_count met: minutes 0.02283333 
## Approximately 75% of max_count met: minutes 0.03336667 
## Approximately 90% of max_count met: minutes 0.0404 
## # of subgroups evaluated based on (up to) maxk-factor combinations 1485 
## % of all-possible combinations (<= maxk) 100 
## k.max= 2 
## Events criteria for control,exp= 10 10 
## # of subgroups with events less than criteria: control, experimental 216 339 
## # of subgroups with sample size less than criteria 621 
## # of subgroups meeting all criteria = 828 
## # of subgroups fitted (Cox model estimable) = 828 
## *Subgroup Searching Minutes=* 0.04376667 
## Number of subgroups meeting HR threshold 56 
## Subgroup candidate(s) found (FS) 
## # of candidate subgroups (meeting HR criteria) =  56 
## SGs (1st 10) meeting screening thresholds sorted by sg_focus= hr 
##      n  E d1   HR L(HR) q24.0 q24.1 q17.0 q17.1 q22.0 q22.1 q3.0 q3.1 q2.0 q2.1
## 1   96 61 29 1.95  1.17     0     1     0     0     0     1    0    0    0    0
## 2   73 36 20 1.89  0.98     0     0     0     0     0     0    0    0    0    0
## 3   79 41 23 1.75  0.94     0     0     0     0     0     0    0    0    0    0
## 4   95 57 29 1.73  1.03     0     0     0     0     0     1    0    0    0    0
## 5   61 38 20 1.71  0.90     0     1     0     0     0     0    0    0    0    0
## 6   68 53 27 1.70  0.98     0     1     0     0     0     0    0    0    0    0
## 7   64 34 19 1.68  0.85     0     1     0     0     0     0    0    1    0    0
## 8   72 45 22 1.67  0.93     0     1     0     0     0     0    0    0    0    0
## 9  106 63 33 1.66  1.01     0     1     0     0     0     0    0    0    0    0
## 10  71 44 24 1.65  0.91     0     1     0     0     0     0    0    0    0    0
## Consistency 0.995 
## # of splits= 400 
## Model, % Consistency Met= {z3} {z1} 0.995 
## SG focus= hr 
## Subgroup Consistency Minutes= 0.03203333 
## Subgroup found (FS) 
## Minutes forestsearch overall= 0.08255 
## FS: GRF stage for cut selection with dmin,tau= 12 0.6 
## tau, maxdepth= 47.98043 2 
##    leaf.node control.mean control.size control.se depth
## 1          2        -3.81       170.00       2.10     1
## 2          3         4.92       130.00       2.58     1
## 11         4        -8.26        80.00       2.96     2
## 4          7         7.43       114.00       2.72     2
##   leaf.node control.mean control.size control.se depth
## 4         7         7.43       114.00       2.72     2
## GRF subgroup found 
## All splits 
## [1] "z2 <= 0"        "noise4 <= 0.29" "z1 <= 0"       
## Terminating node at max.diff (sg.harm.id) 
## [1] "z1 <= 0"
## # of continuous/categorical characteristics 6 6 
## Continuous characteristics: size noise1 noise2 noise3 noise4 noise5 
## Categorical characteristics: z1 z2 z3 z4 z5 grade3 
## CV lambda = 0.03590407 
## 12 x 1 sparse Matrix of class "dgCMatrix"
##                s0
## z1      .        
## z2      .        
## z3      0.3594938
## z4      0.9719108
## z5     -0.9809366
## size    .        
## grade3  .        
## noise1  .        
## noise2  .        
## noise3  .        
## noise4  .        
## noise5  .        
## Cox-LASSO selected: z3 z4 z5 
## Cox-LASSO not selected: z1 z2 size grade3 noise1 noise2 noise3 noise4 noise5 
## Default cuts included from Lasso: 
## Categorical after Lasso: z3 z4 z5 
## Factors per GRF: z2 <= 0 noise4 <= 0.29 z1 <= 0 
## Initial GRF cuts included z2 <= 0 noise4 <= 0.29 z1 <= 0 
## Factors included per GRF (not in lasso) z2 <= 0 noise4 <= 0.29 z1 <= 0 
## # of candidate subgroup factors= 26 
##  [1] "noise4 <= 0.29" "size <= 27.9"   "size <= 25"     "size <= 20"    
##  [5] "size <= 34"     "noise1 <= 0.1"  "noise1 <= -0.7" "noise1 <= 0.7" 
##  [9] "noise2 <= 0"    "noise2 <= -0.1" "noise2 <= -0.6" "noise2 <= 0.7" 
## [13] "noise3 <= 0"    "noise3 <= -0.7" "noise3 <= 0.7"  "noise4 <= 0"   
## [17] "noise4 <= -0.8" "noise4 <= 0.7"  "noise5 <= 0.1"  "noise5 <= -0.5"
## [21] "noise5 <= 0.8"  "z3"             "z4"             "z5"            
## [25] "z2 <= 0"        "z1 <= 0"       
## Number of factors evaluated= 26 
## Confounders per grf screening q22 q17 q3 q26 q2 q15 q6 q1 q4 q14 q24 q23 q19 q5 q13 q16 q10 q21 q25 q12 q20 q8 q9 q11 q7 q18 
##           Factors Labels VI(grf)
## 22             z3    q22  0.1122
## 17 noise4 <= -0.8    q17  0.0648
## 3      size <= 25     q3  0.0634
## 26        z1 <= 0    q26  0.0614
## 2    size <= 27.9     q2  0.0504
## 15  noise3 <= 0.7    q15  0.0454
## 6   noise1 <= 0.1     q6  0.0448
## 1  noise4 <= 0.29     q1  0.0442
## 4      size <= 20     q4  0.0399
## 14 noise3 <= -0.7    q14  0.0385
## 24             z5    q24  0.0385
## 23             z4    q23  0.0354
## 19  noise5 <= 0.1    q19  0.0325
## 5      size <= 34     q5  0.0319
## 13    noise3 <= 0    q13  0.0312
## 16    noise4 <= 0    q16  0.0305
## 10 noise2 <= -0.1    q10  0.0299
## 21  noise5 <= 0.8    q21  0.0295
## 25        z2 <= 0    q25  0.0291
## 12  noise2 <= 0.7    q12  0.0282
## 20 noise5 <= -0.5    q20  0.0263
## 8   noise1 <= 0.7     q8  0.0245
## 9     noise2 <= 0     q9  0.0231
## 11 noise2 <= -0.6    q11  0.0167
## 7  noise1 <= -0.7     q7  0.0156
## 18  noise4 <= 0.7    q18  0.0124
## Number of possible configurations (<= maxk): maxk, # <= maxk 2 1378 
## Approximately 5% of max_count met: minutes 0.0032 
## Approximately 10% of max_count met: minutes 0.006133333 
## Approximately 20% of max_count met: minutes 0.009383333 
## Approximately 33% of max_count met: minutes 0.01485 
## Approximately 50% of max_count met: minutes 0.0213 
## Approximately 75% of max_count met: minutes 0.031 
## Approximately 90% of max_count met: minutes 0.03693333 
## # of subgroups evaluated based on (up to) maxk-factor combinations 1378 
## % of all-possible combinations (<= maxk) 100 
## k.max= 2 
## Events criteria for control,exp= 10 10 
## # of subgroups with events less than criteria: control, experimental 199 310 
## # of subgroups with sample size less than criteria 559 
## # of subgroups meeting all criteria = 783 
## # of subgroups fitted (Cox model estimable) = 783 
## *Subgroup Searching Minutes=* 0.04003333 
## Number of subgroups meeting HR threshold 56 
## Subgroup candidate(s) found (FS) 
## # of candidate subgroups (meeting HR criteria) =  56 
## SGs (1st 10) meeting screening thresholds sorted by sg_focus= hr 
##      n  E d1   HR L(HR) q22.0 q22.1 q17.0 q17.1 q3.0 q3.1 q26.0 q26.1 q2.0 q2.1
## 1   96 61 29 1.95  1.17     0     1     0     0    0    0     1     0    0    0
## 2   73 36 20 1.89  0.98     0     0     0     0    0    0     0     0    0    0
## 3   79 41 23 1.75  0.94     0     0     0     0    0    0     0     0    0    0
## 4   95 57 29 1.73  1.03     0     0     0     0    0    0     1     0    0    0
## 5   61 38 20 1.71  0.90     0     1     0     0    0    0     0     0    0    0
## 6   68 53 27 1.70  0.98     0     1     0     0    0    0     0     0    0    0
## 7   64 34 19 1.68  0.85     0     1     0     0    0    1     0     0    0    0
## 8   72 45 22 1.67  0.93     0     1     0     0    0    0     0     0    0    0
## 9  106 63 33 1.66  1.01     0     1     0     0    0    0     0     0    0    0
## 10  71 44 24 1.65  0.91     0     1     0     0    0    0     0     0    0    0
## Consistency 0.995 
## # of splits= 400 
## Model, % Consistency Met= {z3} !{z1 <= 0} 0.995 
## SG focus= hr 
## Subgroup Consistency Minutes= 0.03001667 
## Subgroup found (FS) 
## Minutes forestsearch overall= 0.07901667 
## FS: GRF stage for cut selection with dmin,tau= 12 0.6 
## tau, maxdepth= 45.36853 2 
##   leaf.node control.mean control.size control.se depth
## 1         2        -5.62       176.00       2.00     1
## 2         3         5.14       124.00       2.53     1
## 3         4         8.89        78.00       3.09     2
## 4         5        -7.27        80.00       2.89     2
## 5         6         4.88        63.00       3.53     2
## 6         7        -9.76        79.00       2.88     2
##   leaf.node control.mean control.size control.se depth
## 3         4         8.89        78.00       3.09     2
## GRF subgroup found 
## All splits 
## [1] "noise1 <= -0.07" "noise5 <= 0.01"  "noise4 <= -0.06"
## Terminating node at max.diff (sg.harm.id) 
## [1] "noise5 <= 0.00807090609630402"
## # of continuous/categorical characteristics 6 6 
## Continuous characteristics: size noise1 noise2 noise3 noise4 noise5 
## Categorical characteristics: z1 z2 z3 z4 z5 grade3 
## Default cuts included (1st 20) 
## Categorical: z1 z2 z3 z4 z5 grade3 
## Factors per GRF: noise1 <= -0.07 noise5 <= 0.01 noise4 <= -0.06 
## Initial GRF cuts included noise1 <= -0.07 noise5 <= 0.01 noise4 <= -0.06 
## # of candidate subgroup factors= 30 
##  [1] "noise1 <= -0.07" "noise5 <= 0.01"  "noise4 <= -0.06" "size <= 29.7"   
##  [5] "size <= 27"      "size <= 21"      "size <= 35"      "noise1 <= -0.1" 
##  [9] "noise1 <= -0.8"  "noise1 <= 0.7"   "noise2 <= -0.1"  "noise2 <= -0.8" 
## [13] "noise2 <= 0.5"   "noise3 <= 0.1"   "noise3 <= 0"     "noise3 <= -0.6" 
## [17] "noise3 <= 0.8"   "noise4 <= 0.1"   "noise4 <= 0"     "noise4 <= -0.6" 
## [21] "noise4 <= 0.8"   "noise5 <= 0"     "noise5 <= -0.7"  "noise5 <= 0.7"  
## [25] "z1"              "z2"              "z3"              "z4"             
## [29] "z5"              "grade3"         
## Number of factors evaluated= 30 
## Confounders per grf screening q26 q27 q2 q28 q22 q3 q25 q1 q29 q11 q5 q8 q15 q23 q14 q24 q18 q17 q4 q19 q16 q13 q12 q9 q30 q6 q21 q20 q7 q10 
##            Factors Labels VI(grf)
## 26              z2    q26  0.1636
## 27              z3    q27  0.1613
## 2   noise5 <= 0.01     q2  0.1153
## 28              z4    q28  0.0785
## 22     noise5 <= 0    q22  0.0542
## 3  noise4 <= -0.06     q3  0.0409
## 25              z1    q25  0.0309
## 1  noise1 <= -0.07     q1  0.0291
## 29              z5    q29  0.0266
## 11  noise2 <= -0.1    q11  0.0252
## 5       size <= 27     q5  0.0211
## 8   noise1 <= -0.1     q8  0.0208
## 15     noise3 <= 0    q15  0.0208
## 23  noise5 <= -0.7    q23  0.0177
## 14   noise3 <= 0.1    q14  0.0175
## 24   noise5 <= 0.7    q24  0.0168
## 18   noise4 <= 0.1    q18  0.0158
## 17   noise3 <= 0.8    q17  0.0153
## 4     size <= 29.7     q4  0.0145
## 19     noise4 <= 0    q19  0.0141
## 16  noise3 <= -0.6    q16  0.0130
## 13   noise2 <= 0.5    q13  0.0121
## 12  noise2 <= -0.8    q12  0.0119
## 9   noise1 <= -0.8     q9  0.0115
## 30          grade3    q30  0.0104
## 6       size <= 21     q6  0.0101
## 21   noise4 <= 0.8    q21  0.0100
## 20  noise4 <= -0.6    q20  0.0089
## 7       size <= 35     q7  0.0072
## 10   noise1 <= 0.7    q10  0.0048
## Number of possible configurations (<= maxk): maxk, # <= maxk 2 1830 
## Approximately 5% of max_count met: minutes 0.004066667 
## Approximately 10% of max_count met: minutes 0.008333333 
## Approximately 20% of max_count met: minutes 0.01538333 
## Approximately 33% of max_count met: minutes 0.025 
## Approximately 50% of max_count met: minutes 0.03513333 
## Approximately 75% of max_count met: minutes 0.04775 
## Approximately 90% of max_count met: minutes 0.05418333 
## # of subgroups evaluated based on (up to) maxk-factor combinations 1830 
## % of all-possible combinations (<= maxk) 100 
## k.max= 2 
## Events criteria for control,exp= 10 10 
## # of subgroups with events less than criteria: control, experimental 293 321 
## # of subgroups with sample size less than criteria 701 
## # of subgroups meeting all criteria = 1078 
## # of subgroups fitted (Cox model estimable) = 1078 
## *Subgroup Searching Minutes=* 0.05716667 
## Number of subgroups meeting HR threshold 183 
## Subgroup candidate(s) found (FS) 
## # of candidate subgroups (meeting HR criteria) =  183 
## SGs (1st 10) meeting screening thresholds sorted by sg_focus= hr 
##     n  E d1   HR L(HR) q26.0 q26.1 q27.0 q27.1 q2.0 q2.1 q28.0 q28.1 q22.0
## 1  70 45 23 3.04  1.62     0     0     0     1    0    0     0     0     0
## 2  70 45 23 3.04  1.62     0     0     0     1    0    0     0     0     0
## 3  64 44 24 2.85  1.53     0     0     0     1    0    0     0     0     0
## 4  85 51 28 2.80  1.57     0     1     0     0    0    0     0     0     0
## 5  85 51 28 2.80  1.57     0     1     0     0    0    0     0     0     0
## 6  66 44 23 2.44  1.33     0     0     0     1    0    0     0     0     0
## 7  94 63 32 2.40  1.44     0     0     0     1    0    0     0     0     0
## 8  72 43 27 2.36  1.26     0     1     0     0    0    0     0     0     0
## 9  90 61 35 2.32  1.39     0     0     0     1    0    0     0     0     0
## 10 93 63 34 2.28  1.36     0     0     0     1    0    0     0     0     0
##    q22.1
## 1      0
## 2      0
## 3      0
## 4      0
## 5      0
## 6      0
## 7      0
## 8      0
## 9      0
## 10     0
## Consistency 1 
## # of splits= 400 
## Model, % Consistency Met= {z3} {noise1 <= -0.07} 1 
## SG focus= hr 
## Subgroup Consistency Minutes= 0.02946667 
## Subgroup found (FS) 
## Minutes forestsearch overall= 0.0931 
## FS: GRF stage for cut selection with dmin,tau= 12 0.6 
## tau, maxdepth= 45.36853 2 
##   leaf.node control.mean control.size control.se depth
## 1         2        -5.62       176.00       2.00     1
## 2         3         5.14       124.00       2.53     1
## 3         4         8.89        78.00       3.09     2
## 4         5        -7.27        80.00       2.89     2
## 5         6         4.88        63.00       3.53     2
## 6         7        -9.76        79.00       2.88     2
##   leaf.node control.mean control.size control.se depth
## 3         4         8.89        78.00       3.09     2
## GRF subgroup found 
## All splits 
## [1] "noise1 <= -0.07" "noise5 <= 0.01"  "noise4 <= -0.06"
## Terminating node at max.diff (sg.harm.id) 
## [1] "noise5 <= 0.00807090609630402"
## # of continuous/categorical characteristics 6 6 
## Continuous characteristics: size noise1 noise2 noise3 noise4 noise5 
## Categorical characteristics: z1 z2 z3 z4 z5 grade3 
## CV lambda = 0.03128063 
## 12 x 1 sparse Matrix of class "dgCMatrix"
##                  s0
## z1      0.114944573
## z2      .          
## z3      0.553874965
## z4      0.974097466
## z5     -0.737588173
## size    .          
## grade3  .          
## noise1  0.082835678
## noise2  0.017275498
## noise3  .          
## noise4  .          
## noise5 -0.001910096
## Cox-LASSO selected: z1 z3 z4 z5 noise1 noise2 noise5 
## Cox-LASSO not selected: z2 size grade3 noise3 noise4 
## Default cuts included from Lasso: 
## Categorical after Lasso: z1 z3 z4 z5 
## Factors per GRF: noise1 <= -0.07 noise5 <= 0.01 noise4 <= -0.06 
## Initial GRF cuts included noise1 <= -0.07 noise5 <= 0.01 noise4 <= -0.06 
## Factors included per GRF (not in lasso) noise1 <= -0.07 noise5 <= 0.01 noise4 <= -0.06 
## # of candidate subgroup factors= 28 
##  [1] "noise1 <= -0.07" "noise5 <= 0.01"  "noise4 <= -0.06" "size <= 29.7"   
##  [5] "size <= 27"      "size <= 21"      "size <= 35"      "noise1 <= -0.1" 
##  [9] "noise1 <= -0.8"  "noise1 <= 0.7"   "noise2 <= -0.1"  "noise2 <= -0.8" 
## [13] "noise2 <= 0.5"   "noise3 <= 0.1"   "noise3 <= 0"     "noise3 <= -0.6" 
## [17] "noise3 <= 0.8"   "noise4 <= 0.1"   "noise4 <= 0"     "noise4 <= -0.6" 
## [21] "noise4 <= 0.8"   "noise5 <= 0"     "noise5 <= -0.7"  "noise5 <= 0.7"  
## [25] "z1"              "z3"              "z4"              "z5"             
## Number of factors evaluated= 28 
## Confounders per grf screening q26 q2 q27 q22 q3 q25 q28 q1 q11 q24 q23 q18 q8 q15 q14 q4 q5 q13 q19 q17 q12 q16 q9 q21 q6 q20 q10 q7 
##            Factors Labels VI(grf)
## 26              z3    q26  0.2530
## 2   noise5 <= 0.01     q2  0.1186
## 27              z4    q27  0.0926
## 22     noise5 <= 0    q22  0.0578
## 3  noise4 <= -0.06     q3  0.0413
## 25              z1    q25  0.0369
## 28              z5    q28  0.0337
## 1  noise1 <= -0.07     q1  0.0288
## 11  noise2 <= -0.1    q11  0.0241
## 24   noise5 <= 0.7    q24  0.0232
## 23  noise5 <= -0.7    q23  0.0222
## 18   noise4 <= 0.1    q18  0.0220
## 8   noise1 <= -0.1     q8  0.0219
## 15     noise3 <= 0    q15  0.0212
## 14   noise3 <= 0.1    q14  0.0203
## 4     size <= 29.7     q4  0.0201
## 5       size <= 27     q5  0.0188
## 13   noise2 <= 0.5    q13  0.0181
## 19     noise4 <= 0    q19  0.0172
## 17   noise3 <= 0.8    q17  0.0161
## 12  noise2 <= -0.8    q12  0.0155
## 16  noise3 <= -0.6    q16  0.0154
## 9   noise1 <= -0.8     q9  0.0137
## 21   noise4 <= 0.8    q21  0.0114
## 6       size <= 21     q6  0.0112
## 20  noise4 <= -0.6    q20  0.0099
## 10   noise1 <= 0.7    q10  0.0078
## 7       size <= 35     q7  0.0072
## Number of possible configurations (<= maxk): maxk, # <= maxk 2 1596 
## Approximately 5% of max_count met: minutes 0.003533333 
## Approximately 10% of max_count met: minutes 0.006683333 
## Approximately 20% of max_count met: minutes 0.01345 
## Approximately 33% of max_count met: minutes 0.02121667 
## Approximately 50% of max_count met: minutes 0.02983333 
## Approximately 75% of max_count met: minutes 0.0407 
## Approximately 90% of max_count met: minutes 0.04628333 
## # of subgroups evaluated based on (up to) maxk-factor combinations 1596 
## % of all-possible combinations (<= maxk) 100 
## k.max= 2 
## Events criteria for control,exp= 10 10 
## # of subgroups with events less than criteria: control, experimental 261 285 
## # of subgroups with sample size less than criteria 603 
## # of subgroups meeting all criteria = 945 
## # of subgroups fitted (Cox model estimable) = 945 
## *Subgroup Searching Minutes=* 0.04951667 
## Number of subgroups meeting HR threshold 140 
## Subgroup candidate(s) found (FS) 
## # of candidate subgroups (meeting HR criteria) =  140 
## SGs (1st 10) meeting screening thresholds sorted by sg_focus= hr 
##     n  E d1   HR L(HR) q26.0 q26.1 q2.0 q2.1 q27.0 q27.1 q22.0 q22.1 q3.0 q3.1
## 1  70 45 23 3.04  1.62     0     1    0    0     0     0     0     0    0    0
## 2  70 45 23 3.04  1.62     0     1    0    0     0     0     0     0    0    0
## 3  64 44 24 2.85  1.53     0     1    0    0     0     0     0     0    0    0
## 4  66 44 23 2.44  1.33     0     1    0    0     0     0     0     0    0    0
## 5  94 63 32 2.40  1.44     0     1    0    0     0     0     0     0    0    0
## 6  90 61 35 2.32  1.39     0     1    0    0     0     0     0     0    0    0
## 7  93 63 34 2.28  1.36     0     1    0    0     0     0     0     0    0    0
## 8  69 50 31 2.20  1.23     0     1    0    1     0     0     0     0    0    0
## 9  68 49 31 2.18  1.20     0     1    0    0     0     0     0     1    0    0
## 10 89 72 41 2.15  1.32     0     1    0    0     0     0     0     0    0    0
## Consistency 1 
## # of splits= 400 
## Model, % Consistency Met= {z3} {noise1 <= -0.07} 1 
## SG focus= hr 
## Subgroup Consistency Minutes= 0.03228333 
## Subgroup found (FS) 
## Minutes forestsearch overall= 0.08936667
\end{verbatim}
\begin{alltt}
\hlstd{t.now} \hlkwb{<-} \hlkwd{proc.time}\hlstd{()[}\hlnum{3}\hlstd{]}
\hlstd{t.min} \hlkwb{<-} \hlstd{(t.now} \hlopt{-} \hlstd{t.start)}\hlopt{/}\hlnum{60}


\hlkwd{print}\hlstd{(}\hlkwd{table}\hlstd{(res}\hlopt{$}\hlstd{analysis))}
\end{alltt}
\begin{verbatim}
## 
##     FSl    FSlg     GRF  GRF.60  VT(24)  VT(36) VT#(24) VT#(36) 
##   20000   20000   20000   20000   20000   20000   20000   20000
\end{verbatim}
\begin{alltt}
\hlstd{check} \hlkwb{<-} \hlkwd{c}\hlstd{(}\hlkwd{c}\hlstd{(}\hlkwd{table}\hlstd{(res}\hlopt{$}\hlstd{analysis))} \hlopt{-} \hlstd{Nsims)}
\hlkwa{if} \hlstd{(}\hlkwd{all}\hlstd{(check} \hlopt{!=} \hlnum{0}\hlstd{))} \hlkwd{stop}\hlstd{(}\hlstr{"All analyses not complete"}\hlstd{)}

\hlstd{dgm_alt} \hlkwb{<-} \hlstd{dgm}

\hlstd{outres} \hlkwb{<-} \hlkwd{out.results}\hlstd{(}\hlkwc{res} \hlstd{= res,} \hlkwc{dgm} \hlstd{= dgm,} \hlkwc{output.file} \hlstd{= output.file,} \hlkwc{t.min} \hlstd{= t.min,}
    \hlkwc{out_analysis} \hlstd{=} \hlstr{"FSl"}\hlstd{)}
\end{alltt}
\begin{verbatim}
## [1] "results/oc_sims=20000_m4c-Noise=5_N=300_alt_ktreat=1.5_hrH=2_v0-4cuts.Rdata"
##      sim sizeH_true propH_true sizeHc_true propHc_true any.H size.H size.Hc
##    <int>      <num>      <num>       <int>       <num> <num>  <num>   <int>
## 1:     1         80  0.2666667         220   0.7333333     1     67     233
## 2:     1         80  0.2666667         220   0.7333333     1     67     233
## 3:     1         80  0.2666667         220   0.7333333     1    101     199
## 4:     1         80  0.2666667         220   0.7333333     1     82     218
## 5:     1         80  0.2666667         220   0.7333333     1     80     220
## 6:     1         80  0.2666667         220   0.7333333     1     80     220
##      ppv       npv specificity sensitivity found.1 found.2 found.both found.al3
##    <num>     <num>       <num>       <num>   <num>   <num>      <num>     <num>
## 1:  0.20 0.7681818   0.7253219   0.2388060       0       0          0         0
## 2:  0.20 0.7681818   0.7253219   0.2388060       0       0          0         0
## 3:  0.40 0.6863636   0.7587940   0.3168317      NA      NA         NA        NA
## 4:  0.35 0.7545455   0.7614679   0.3414634      NA      NA         NA        NA
## 5:  1.00 1.0000000   1.0000000   1.0000000       0       0          0         0
## 6:  1.00 1.0000000   1.0000000   1.0000000       0       0          0         0
##    hr.H.true hr.Hc.true hr.H.hat hr.Hc.hat        b1.H       b2.H         b1.Hc
##        <num>      <num>    <num>     <num>       <num>      <num>         <num>
## 1:  1.559409  0.6836811 1.891602 0.6831815  0.33219378 -0.1083970 -0.0004996335
## 2:  1.559409  0.6836811 1.891602 0.6831815  0.33219378 -0.1083970 -0.0004996335
## 3:  1.559409  0.6836811 1.599971 0.6172136  0.04056242 -0.4000284 -0.0664675443
## 4:  1.559409  0.6836811 1.405952 0.7059411 -0.15345651 -0.5940473  0.0222599774
## 5:  1.559409  0.6836811 1.559409 0.6836811  0.00000000 -0.4405908  0.0000000000
## 6:  1.559409  0.6836811 1.559409 0.6836811  0.00000000 -0.4405908  0.0000000000
##         b2.Hc    p.cens analysis   taumax    hr.itt     l.itt    u.itt
##         <num>     <num>   <char>    <num>     <num>     <num>    <num>
## 1: 0.12555050 0.4033333      FSl 81.76877 0.8477298 0.6315583 1.137893
## 2: 0.12555050 0.4033333     FSlg 49.06126 0.8477298 0.6315583 1.137893
## 3: 0.05958259 0.4033333      GRF 81.76877 0.8477298 0.6315583 1.137893
## 4: 0.14831011 0.4033333   GRF.60 49.06126 0.8477298 0.6315583 1.137893
## 5: 0.12605013 0.4033333   VT(24) 81.76877 0.8477298 0.6315583 1.137893
## 6: 0.12605013 0.4033333  VT#(24) 81.76877 0.8477298 0.6315583 1.137893
##    hr.adj.itt l.adj.itt u.adj.itt  l.H.true u.H.true l.Hc.true u.Hc.true
##         <num>     <num>     <num>     <num>    <num>     <num>     <num>
## 1:  0.8490589 0.6265376  1.150611 0.9351283 2.600451 0.4758943 0.9821926
## 2:  0.8490589 0.6265376  1.150611 0.9351283 2.600451 0.4758943 0.9821926
## 3:  0.8490589 0.6265376  1.150611 0.9351283 2.600451 0.4758943 0.9821926
## 4:  0.8490589 0.6265376  1.150611 0.9351283 2.600451 0.4758943 0.9821926
## 5:  0.8490589 0.6265376  1.150611 0.9351283 2.600451 0.4758943 0.9821926
## 6:  0.8490589 0.6265376  1.150611 0.9351283 2.600451 0.4758943 0.9821926
##      l.H.hat  u.H.hat  l.Hc.hat  u.Hc.hat
##        <num>    <num>     <num>     <num>
## 1: 1.0260505 3.487313 0.4870878 0.9582194
## 2: 1.0260505 3.487313 0.4870878 0.9582194
## 3: 0.9467982 2.703751 0.4287005 0.8886217
## 4: 0.7789088 2.537782 0.5015604 0.9936048
## 5: 0.9351283 2.600451 0.4758943 0.9821926
## 6: 0.9351283 2.600451 0.4758943 0.9821926
## Subgroup HRs: H, H^c, Causal= 1.999999 0.557631 0.7363833 
## Simulations= 20000 
## Avg censoring= 0.4375567 
## Min,Max,Avg tau.max= 58.28239 83.94548 78.62153 
## P(H) approximation at causal(H), n(sg)=60, approx= 1.999999 60 0.8326675 
## P(H) approximation at causal(H), Avg(n(sg)), approx= 1.999999 90 0.9052625 
## P(H) approximation at plim(H), Avg(n(sg)), approx= 2.246475 90 0.9522671 
## Minutes,hours 123.6496 2.060826 
##                    FSl    FSlg     GRF  GRF.60  VT(24) VT#(24)  VT(36) VT#(36)
## any.H            0.970   0.960   0.960   0.870   0.510   0.560   0.530   0.650
## sensH            0.680   0.660   0.730   0.620   0.350   0.420   0.380   0.520
## sensHc           0.930   0.930   0.880   0.870   0.950   0.960   0.950   0.960
## ppH              0.780   0.750   0.700   0.590   0.390   0.450   0.400   0.550
## ppHc             0.880   0.870   0.890   0.860   0.790   0.810   0.800   0.840
## Avg(#H)         78.000  77.000  95.000  96.000  83.000  83.000  85.000  85.000
## minH            61.000  61.000  60.000  60.000  60.000  60.000  60.000  60.000
## maxH           143.000 143.000 229.000 230.000 172.000 176.000 180.000 191.000
## Avg(#Hc)       225.000 226.000 209.000 216.000 258.000 254.000 255.000 245.000
## minHc          157.000 157.000  71.000  70.000 128.000 124.000 120.000 109.000
## maxHc          300.000 300.000 300.000 300.000 300.000 300.000 300.000 300.000
## hat(H*)          2.278   2.285   2.277   2.319   2.451   2.450   2.468   2.439
## hat(hat[H])      2.588   2.571   2.213   2.071   2.191   2.286   2.261   2.386
## hat(Hc*)         0.555   0.555   0.555   0.555   0.559   0.555   0.558   0.555
## hat(hat[Hc])     0.592   0.597   0.550   0.574   0.637   0.618   0.622   0.595
## hat(H*)all       2.246   2.246   2.246   2.246   2.246   2.246   2.246   2.246
## hat(Hc*)all      0.553   0.553   0.553   0.553   0.553   0.553   0.553   0.553
## hat(ITT)all      0.849   0.849   0.849   0.849   0.849   0.849   0.849   0.849
## hat(ITTadj)all   0.896   0.896   0.896   0.896   0.896   0.896   0.896   0.896
\end{verbatim}
\begin{alltt}
\hlstd{missC} \hlkwb{<-} \hlkwd{tab_tests}\hlstd{(}\hlkwc{res} \hlstd{= res)}

\hlstd{pA} \hlkwb{<-} \hlkwd{as.character}\hlstd{(}\hlkwd{round}\hlstd{(outres}\hlopt{$}\hlstd{pAnyH.approx2,} \hlnum{4}\hlstd{))}

\hlstd{tabsim_missC} \hlkwb{<-} \hlkwd{get_tabsim}\hlstd{(}\hlkwc{missC} \hlstd{= missC,} \hlkwc{pA} \hlstd{= pA,} \hlkwc{est_names} \hlstd{= est_names,} \hlkwc{stat_names} \hlstd{= stat_names,}
    \hlkwc{mod.harm} \hlstd{= mod.harm,} \hlkwc{Nsims} \hlstd{= Nsims)}
\end{alltt}
\end{kframe}
\end{knitrout}

\begin{table}[!h]
\centering
\caption{\label{tab:r hrh2}Average classification rates: ${avg}\vert \hat{H} \vert$, ${min}\vert \hat{H} \vert$, and ${max}\vert \hat{H} \vert$, denote the average, 
minimum, and maximum of the number of subjects in the estimated subgroup $\hat{H}$ (analogously for $\hat{H}^{c}$).  
Note that under the null $sens(\hat{H})$ is undefined and $ppv(\hat{H})=0$.}
\centering
\fontsize{9}{11}\selectfont
\begin{tabular}[t]{lcccccccc}
\toprule
  & $FS_{g}$ & $FS_{lg}$ & $GRF$ & $GRF_{60}$ & $VT(24)$ & ${VT}^{\#}(24)$ & $VT(36)$ & ${VT}^{\#}(36)$\\
\midrule
\addlinespace[0.3em]
\multicolumn{9}{l}{\textbf{Finding H}}\\
\hspace{1em}any(H) & 0.97 & 0.96 & 0.96 & 0.87 & 0.51 & 0.56 & 0.53 & 0.65\\
\hspace{1em}${sens}(\hat{H})$ & 0.68 & 0.66 & 0.73 & 0.62 & 0.35 & 0.42 & 0.38 & 0.52\\
\hspace{1em}${sens}(\hat{H}^{C})$ & 0.93 & 0.93 & 0.88 & 0.87 & 0.95 & 0.96 & 0.95 & 0.96\\
\hspace{1em}${ppv}(\hat{H})$ & 0.78 & 0.75 & 0.7 & 0.59 & 0.39 & 0.45 & 0.4 & 0.55\\
\hspace{1em}${ppv}(\hat{H}^{C})$ & 0.88 & 0.87 & 0.89 & 0.86 & 0.79 & 0.81 & 0.8 & 0.84\\
\addlinespace[0.3em]
\multicolumn{9}{l}{\textbf{Size of H and H-complement}}\\
\hspace{1em}${avg}\vert \hat{H} \vert$ & 78 & 77 & 95 & 96 & 83 & 83 & 85 & 85\\
\hspace{1em}${min}\vert \hat{H} \vert$ & 61 & 61 & 60 & 60 & 60 & 60 & 60 & 60\\
\hspace{1em}${max}\vert \hat{H} \vert$ & 143 & 143 & 229 & 230 & 172 & 176 & 180 & 191\\
\hspace{1em}${avg}\vert \hat{H}^{C} \vert$ & 225 & 226 & 209 & 216 & 258 & 254 & 255 & 245\\
\hspace{1em}${min}\vert \hat{H}^{C} \vert$ & 157 & 157 & 71 & 70 & 128 & 124 & 120 & 109\\
\hspace{1em}${max}\vert \hat{H}^{C} \vert$ & 300 & 300 & 300 & 300 & 300 & 300 & 300 & 300\\
\bottomrule
\multicolumn{9}{l}{\rule{0pt}{1em}\textit{Note: } Number of simulations= 20000 .}\\
\multicolumn{9}{l}{\rule{0pt}{1em}\textit{Note: } Probability approximation= 0.9053 .}\\
\end{tabular}
\end{table}




\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{t.done} \hlkwb{<-} \hlkwd{proc.time}\hlstd{()[}\hlnum{3}\hlstd{]}
\hlstd{t.min} \hlkwb{<-} \hlstd{(t.done} \hlopt{-} \hlstd{t.start.all)}\hlopt{/}\hlnum{60}
\hlkwd{cat}\hlstd{(}\hlstr{"Minutes and hours to finish"}\hlstd{,} \hlkwd{c}\hlstd{(t.min, t.min}\hlopt{/}\hlnum{60}\hlstd{),} \hlstr{"\textbackslash{}n"}\hlstd{)}
\end{alltt}
\begin{verbatim}
## Minutes and hours to finish 217.5104 3.625174
\end{verbatim}
\begin{alltt}
\hlkwd{cat}\hlstd{(}\hlstr{"Minutes and hours per 10,000 to finish"}\hlstd{, (}\hlnum{10000}\hlopt{/}\hlstd{Nsims)} \hlopt{*} \hlkwd{c}\hlstd{(t.min, t.min}\hlopt{/}\hlnum{60}\hlstd{),}
    \hlstr{"\textbackslash{}n"}\hlstd{)}
\end{alltt}
\begin{verbatim}
## Minutes and hours per 10,000 to finish 108.7552 1.812587
\end{verbatim}
\begin{alltt}
\hlcom{# cat('Machine=',c(Sys.info()[[4]]),'\textbackslash{}n') cat('Number of}
\hlcom{# cores=',c(detectCores(logical = FALSE)),'\textbackslash{}n')}
\hlkwd{require}\hlstd{(benchmarkme)}
\hlstd{my_system} \hlkwb{<-} \hlkwd{get_cpu}\hlstd{()}
\hlstd{my_ram} \hlkwb{<-} \hlkwd{get_ram}\hlstd{()}
\hlkwd{cat}\hlstd{(}\hlstr{"Running on system:"}\hlstd{,} \hlkwd{c}\hlstd{(my_system}\hlopt{$}\hlstd{model_name),} \hlstr{"\textbackslash{}n"}\hlstd{)}
\end{alltt}
\begin{verbatim}
## Running on system: AMD Ryzen Threadripper PRO 5995WX 64-Cores
\end{verbatim}
\begin{alltt}
\hlkwd{cat}\hlstd{(}\hlstr{"with number of cores and cpu/GB="}\hlstd{,} \hlkwd{c}\hlstd{(my_system}\hlopt{$}\hlstd{no_of_cores,} \hlkwd{round}\hlstd{(}\hlkwd{c}\hlstd{(my_ram)}\hlopt{/}\hlnum{10}\hlopt{^}\hlnum{9}\hlstd{,}
    \hlnum{0}\hlstd{)),} \hlstr{"\textbackslash{}n"}\hlstd{)}
\end{alltt}
\begin{verbatim}
## with number of cores and cpu/GB= 128 270
\end{verbatim}
\end{kframe}
\end{knitrout}



\end{document}














